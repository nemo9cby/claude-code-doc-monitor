<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>plugins-reference - Diff Report</title>
    <link rel="stylesheet" href="../../css/diff.css">
    <style>
        :root {
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --text-color: #eee;
            --accent: #0f3460;
            --add-bg: #1a4d1a;
            --del-bg: #4d1a1a;
            --add-text: #4ade80;
            --del-text: #f87171;
        }
        @media (prefers-color-scheme: light) {
            :root {
                --bg-color: #f5f5f5;
                --card-bg: #fff;
                --text-color: #333;
                --accent: #e0e0e0;
                --add-bg: #d4edda;
                --del-bg: #f8d7da;
                --add-text: #155724;
                --del-text: #721c24;
            }
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 2rem;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { margin-bottom: 2rem; }
        h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .meta { color: #888; font-size: 0.9rem; }
        .summary {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            display: flex;
            gap: 2rem;
        }
        .stat { display: flex; align-items: center; gap: 0.5rem; }
        .stat.added { color: var(--add-text); }
        .stat.removed { color: var(--del-text); }
        .analysis {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border-left: 4px solid #8b5cf6;
        }
        .analysis-header {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #8b5cf6;
        }
        .analysis-content {
            white-space: pre-wrap;
            font-size: 0.95rem;
            line-height: 1.7;
        }
        .diff-container {
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
        }
        .diff-header {
            background: var(--accent);
            padding: 0.75rem 1rem;
            font-weight: 600;
        }
        .diff-content {
            padding: 1rem;
            overflow-x: auto;
        }
        .diff-content ins {
            background: var(--add-bg);
            color: var(--add-text);
            text-decoration: none;
            padding: 0.1em 0.2em;
            border-radius: 2px;
        }
        .diff-content del {
            background: var(--del-bg);
            color: var(--del-text);
            text-decoration: line-through;
            padding: 0.1em 0.2em;
            border-radius: 2px;
        }
        pre {
            background: var(--accent);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
            margin-top: 2rem;
        }
        a { color: #60a5fa; }
        .back-link { margin-bottom: 1rem; display: inline-block; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">&larr; Back to daily report</a>

        <header>
            <h1>plugins-reference.md</h1>
            <p class="meta">Changed on 2026-02-26 15:31:20 EST</p>
        </header>

        <div class="summary">
            <div class="stat added">
                <span>+1</span> lines added
            </div>
            <div class="stat removed">
                <span>-0</span> lines removed
            </div>
        </div>

        

        <div class="diff-container">
            <div class="diff-header">Visual Diff</div>
            <div class="diff-content"><span>&gt; ## Documentation Index&para;<br>&gt; Fetch the complete documentation index at: https://code.claude.com/docs/llms.txt&para;<br>&gt; Use this file to discover all available pages before exploring further.&para;<br>&para;<br># Plugins reference&para;<br>&para;<br>&gt; Complete technical reference for Claude Code plugin system, including schemas, CLI commands, and component specifications.&para;<br>&para;<br>&lt;Tip&gt;&para;<br>  Looking to install plugins? See [Discover and install plugins](/en/discover-plugins). For creating plugins, see [Plugins](/en/plugins). For distributing plugins, see [Plugin marketplaces](/en/plugin-marketplaces).&para;<br>&lt;/Tip&gt;&para;<br>&para;<br>This reference provides complete technical specifications for the Claude Code plugin system, including component schemas, CLI commands, and development tools.&para;<br>&para;<br>A **plugin** is a self-contained directory of components that extends Claude Code with custom functionality. Plugin components include skills, agents, hooks, MCP servers, and LSP servers.&para;<br>&para;<br>## Plugin components reference&para;<br>&para;<br>### Skills&para;<br>&para;<br>Plugins add skills to Claude Code, creating `/name` shortcuts that you or Claude can invoke.&para;<br>&para;<br>**Location**: `skills/` or `commands/` directory in plugin root&para;<br>&para;<br>**File format**: Skills are directories with `SKILL.md`; commands are simple markdown files&para;<br>&para;<br>**Skill structure**:&para;<br>&para;<br>```</span><ins style="background:#e6ffe6;">text  theme={null}</ins><span>&para;<br>skills/&para;<br>├── pdf-processor/&para;<br>│   ├── SKILL.md&para;<br>│   ├── reference.md (optional)&para;<br>│   └── scripts/ (optional)&para;<br>└── code-reviewer/&para;<br>    └── SKILL.md&para;<br>```&para;<br>&para;<br>**Integration behavior**:&para;<br>&para;<br>* Skills and commands are automatically discovered when the plugin is installed&para;<br>* Claude can invoke them automatically based on task context&para;<br>* Skills can include supporting files alongside SKILL.md&para;<br>&para;<br>For complete details, see [Skills](/en/skills).&para;<br>&para;<br>### Agents&para;<br>&para;<br>Plugins can provide specialized subagents for specific tasks that Claude can invoke automatically when appropriate.&para;<br>&para;<br>**Location**: `agents/` directory in plugin root&para;<br>&para;<br>**File format**: Markdown files describing agent capabilities&para;<br>&para;<br>**Agent structure**:&para;<br>&para;<br>```markdown  theme={null}&para;<br>---&para;<br>name: agent-name&para;<br>description: What this agent specializes in and when Claude should invoke it&para;<br>---&para;<br>&para;<br>Detailed system prompt for the agent describing its role, expertise, and behavior.&para;<br>```&para;<br>&para;<br>**Integration points**:&para;<br>&para;<br>* Agents appear in the `/agents` interface&para;<br>* Claude can invoke agents automatically based on task context&para;<br>* Agents can be invoked manually by users&para;<br>* Plugin agents work alongside built-in Claude agents&para;<br>&para;<br>For complete details, see [Subagents](/en/sub-agents).&para;<br>&para;<br>### Hooks&para;<br>&para;<br>Plugins can provide event handlers that respond to Claude Code events automatically.&para;<br>&para;<br>**Location**: `hooks/hooks.json` in plugin root, or inline in plugin.json&para;<br>&para;<br>**Format**: JSON configuration with event matchers and actions&para;<br>&para;<br>**Hook configuration**:&para;<br>&para;<br>```json  theme={null}&para;<br>{&para;<br>  "hooks": {&para;<br>    "PostToolUse": [&para;<br>      {&para;<br>        "matcher": "Write|Edit",&para;<br>        "hooks": [&para;<br>          {&para;<br>            "type": "command",&para;<br>            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/format-code.sh"&para;<br>          }&para;<br>        ]&para;<br>      }&para;<br>    ]&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>**Available events**:&para;<br>&para;<br>* `PreToolUse`: Before Claude uses any tool&para;<br>* `PostToolUse`: After Claude successfully uses any tool&para;<br>* `PostToolUseFailure`: After Claude tool execution fails&para;<br>* `PermissionRequest`: When a permission dialog is shown&para;<br>* `UserPromptSubmit`: When user submits a prompt&para;<br>* `Notification`: When Claude Code sends notifications&para;<br>* `Stop`: When Claude attempts to stop&para;<br>* `SubagentStart`: When a subagent is started&para;<br>* `SubagentStop`: When a subagent attempts to stop&para;<br>* `SessionStart`: At the beginning of sessions&para;<br>* `SessionEnd`: At the end of sessions&para;<br>* `TeammateIdle`: When an agent team teammate is about to go idle&para;<br>* `TaskCompleted`: When a task is being marked as completed&para;<br>* `PreCompact`: Before conversation history is compacted&para;<br>&para;<br>**Hook types**:&para;<br>&para;<br>* `command`: Execute shell commands or scripts&para;<br>* `prompt`: Evaluate a prompt with an LLM (uses `$ARGUMENTS` placeholder for context)&para;<br>* `agent`: Run an agentic verifier with tools for complex verification tasks&para;<br>&para;<br>### MCP servers&para;<br>&para;<br>Plugins can bundle Model Context Protocol (MCP) servers to connect Claude Code with external tools and services.&para;<br>&para;<br>**Location**: `.mcp.json` in plugin root, or inline in plugin.json&para;<br>&para;<br>**Format**: Standard MCP server configuration&para;<br>&para;<br>**MCP server configuration**:&para;<br>&para;<br>```json  theme={null}&para;<br>{&para;<br>  "mcpServers": {&para;<br>    "plugin-database": {&para;<br>      "command": "${CLAUDE_PLUGIN_ROOT}/servers/db-server",&para;<br>      "args": ["--config", "${CLAUDE_PLUGIN_ROOT}/config.json"],&para;<br>      "env": {&para;<br>        "DB_PATH": "${CLAUDE_PLUGIN_ROOT}/data"&para;<br>      }&para;<br>    },&para;<br>    "plugin-api-client": {&para;<br>      "command": "npx",&para;<br>      "args": ["@company/mcp-server", "--plugin-mode"],&para;<br>      "cwd": "${CLAUDE_PLUGIN_ROOT}"&para;<br>    }&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>**Integration behavior**:&para;<br>&para;<br>* Plugin MCP servers start automatically when the plugin is enabled&para;<br>* Servers appear as standard MCP tools in Claude's toolkit&para;<br>* Server capabilities integrate seamlessly with Claude's existing tools&para;<br>* Plugin servers can be configured independently of user MCP servers&para;<br>&para;<br>### LSP servers&para;<br>&para;<br>&lt;Tip&gt;&para;<br>  Looking to use LSP plugins? Install them from the official marketplace: search for "lsp" in the `/plugin` Discover tab. This section documents how to create LSP plugins for languages not covered by the official marketplace.&para;<br>&lt;/Tip&gt;&para;<br>&para;<br>Plugins can provide [Language Server Protocol](https://microsoft.github.io/language-server-protocol/) (LSP) servers to give Claude real-time code intelligence while working on your codebase.&para;<br>&para;<br>LSP integration provides:&para;<br>&para;<br>* **Instant diagnostics**: Claude sees errors and warnings immediately after each edit&para;<br>* **Code navigation**: go to definition, find references, and hover information&para;<br>* **Language awareness**: type information and documentation for code symbols&para;<br>&para;<br>**Location**: `.lsp.json` in plugin root, or inline in `plugin.json`&para;<br>&para;<br>**Format**: JSON configuration mapping language server names to their configurations&para;<br>&para;<br>**`.lsp.json` file format**:&para;<br>&para;<br>```json  theme={null}&para;<br>{&para;<br>  "go": {&para;<br>    "command": "gopls",&para;<br>    "args": ["serve"],&para;<br>    "extensionToLanguage": {&para;<br>      ".go": "go"&para;<br>    }&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>**Inline in `plugin.json`**:&para;<br>&para;<br>```json  theme={null}&para;<br>{&para;<br>  "name": "my-plugin",&para;<br>  "lspServers": {&para;<br>    "go": {&para;<br>      "command": "gopls",&para;<br>      "args": ["serve"],&para;<br>      "extensionToLanguage": {&para;<br>        ".go": "go"&para;<br>      }&para;<br>    }&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>**Required fields:**&para;<br>&para;<br>| Field                 | Description                                  |&para;<br>| :-------------------- | :------------------------------------------- |&para;<br>| `command`             | The LSP binary to execute (must be in PATH)  |&para;<br>| `extensionToLanguage` | Maps file extensions to language identifiers |&para;<br>&para;<br>**Optional fields:**&para;<br>&para;<br>| Field                   | Description                                               |&para;<br>| :---------------------- | :-------------------------------------------------------- |&para;<br>| `args`                  | Command-line arguments for the LSP server                 |&para;<br>| `transport`             | Communication transport: `stdio` (default) or `socket`    |&para;<br>| `env`                   | Environment variables to set when starting the server     |&para;<br>| `initializationOptions` | Options passed to the server during initialization        |&para;<br>| `settings`              | Settings passed via `workspace/didChangeConfiguration`    |&para;<br>| `workspaceFolder`       | Workspace folder path for the server                      |&para;<br>| `startupTimeout`        | Max time to wait for server startup (milliseconds)        |&para;<br>| `shutdownTimeout`       | Max time to wait for graceful shutdown (milliseconds)     |&para;<br>| `restartOnCrash`        | Whether to automatically restart the server if it crashes |&para;<br>| `maxRestarts`           | Maximum number of restart attempts before giving up       |&para;<br>&para;<br>&lt;Warning&gt;&para;<br>  **You must install the language server binary separately.** LSP plugins configure how Claude Code connects to a language server, but they don't include the server itself. If you see `Executable not found in $PATH` in the `/plugin` Errors tab, install the required binary for your language.&para;<br>&lt;/Warning&gt;&para;<br>&para;<br>**Available LSP plugins:**&para;<br>&para;<br>| Plugin           | Language server            | Install command                                                                            |&para;<br>| :--------------- | :------------------------- | :----------------------------------------------------------------------------------------- |&para;<br>| `pyright-lsp`    | Pyright (Python)           | `pip install pyright` or `npm install -g pyright`                                          |&para;<br>| `typescript-lsp` | TypeScript Language Server | `npm install -g typescript-language-server typescript`                                     |&para;<br>| `rust-lsp`       | rust-analyzer              | [See rust-analyzer installation](https://rust-analyzer.github.io/manual.html#installation) |&para;<br>&para;<br>Install the language server first, then install the plugin from the marketplace.&para;<br>&para;<br>***&para;<br>&para;<br>## Plugin installation scopes&para;<br>&para;<br>When you install a plugin, you choose a **scope** that determines where the plugin is available and who else can use it:&para;<br>&para;<br>| Scope     | Settings file                                   | Use case                                                 |&para;<br>| :-------- | :---------------------------------------------- | :------------------------------------------------------- |&para;<br>| `user`    | `~/.claude/settings.json`                       | Personal plugins available across all projects (default) |&para;<br>| `project` | `.claude/settings.json`                         | Team plugins shared via version control                  |&para;<br>| `local`   | `.claude/settings.local.json`                   | Project-specific plugins, gitignored                     |&para;<br>| `managed` | [Managed settings](/en/settings#settings-files) | Managed plugins (read-only, update only)                 |&para;<br>&para;<br>Plugins use the same scope system as other Claude Code configurations. For installation instructions and scope flags, see [Install plugins](/en/discover-plugins#install-plugins). For a complete explanation of scopes, see [Configuration scopes](/en/settings#configuration-scopes).&para;<br>&para;<br>***&para;<br>&para;<br>## Plugin manifest schema&para;<br>&para;<br>The `.claude-plugin/plugin.json` file defines your plugin's metadata and configuration. This section documents all supported fields and options.&para;<br>&para;<br>The manifest is optional. If omitted, Claude Code auto-discovers components in [default locations](#file-locations-reference) and derives the plugin name from the directory name. Use a manifest when you need to provide metadata or custom component paths.&para;<br>&para;<br>### Complete schema&para;<br>&para;<br>```json  theme={null}&para;<br>{&para;<br>  "name": "plugin-name",&para;<br>  "version": "1.2.0",&para;<br>  "description": "Brief plugin description",&para;<br>  "author": {&para;<br>    "name": "Author Name",&para;<br>    "email": "author@example.com",&para;<br>    "url": "https://github.com/author"&para;<br>  },&para;<br>  "homepage": "https://docs.example.com/plugin",&para;<br>  "repository": "https://github.com/author/plugin",&para;<br>  "license": "MIT",&para;<br>  "keywords": ["keyword1", "keyword2"],&para;<br>  "commands": ["./custom/commands/special.md"],&para;<br>  "agents": "./custom/agents/",&para;<br>  "skills": "./custom/skills/",&para;<br>  "hooks": "./config/hooks.json",&para;<br>  "mcpServers": "./mcp-config.json",&para;<br>  "outputStyles": "./styles/",&para;<br>  "lspServers": "./.lsp.json"&para;<br>}&para;<br>```&para;<br>&para;<br>### Required fields&para;<br>&para;<br>If you include a manifest, `name` is the only required field.&para;<br>&para;<br>| Field  | Type   | Description                               | Example              |&para;<br>| :----- | :----- | :---------------------------------------- | :------------------- |&para;<br>| `name` | string | Unique identifier (kebab-case, no spaces) | `"deployment-tools"` |&para;<br>&para;<br>This name is used for namespacing components. For example, in the UI, the&para;<br>agent `agent-creator` for the plugin with name `plugin-dev` will appear as&para;<br>`plugin-dev:agent-creator`.&para;<br>&para;<br>### Metadata fields&para;<br>&para;<br>| Field         | Type   | Description                                                                                                                 | Example                                            |&para;<br>| :------------ | :----- | :-------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------- |&para;<br>| `version`     | string | Semantic version. If also set in the marketplace entry, `plugin.json` takes priority. You only need to set it in one place. | `"2.1.0"`                                          |&para;<br>| `description` | string | Brief explanation of plugin purpose                                                                                         | `"Deployment automation tools"`                    |&para;<br>| `author`      | object | Author information                                                                                                          | `{"name": "Dev Team", "email": "dev@company.com"}` |&para;<br>| `homepage`    | string | Documentation URL                                                                                                           | `"https://docs.example.com"`                       |&para;<br>| `repository`  | string | Source code URL                                                                                                             | `"https://github.com/user/plugin"`                 |&para;<br>| `license`     | string | License identifier                                                                                                          | `"MIT"`, `"Apache-2.0"`                            |&para;<br>| `keywords`    | array  | Discovery tags                                                                                                              | `["deployment", "ci-cd"]`                          |&para;<br>&para;<br>### Component path fields&para;<br>&para;<br>| Field          | Type                  | Description                                                                                                                                               | Example                                |&para;<br>| :------------- | :-------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------- |&para;<br>| `commands`     | string\|array         | Additional command files/directories                                                                                                                      | `"./custom/cmd.md"` or `["./cmd1.md"]` |&para;<br>| `agents`       | string\|array         | Additional agent files                                                                                                                                    | `"./custom/agents/reviewer.md"`        |&para;<br>| `skills`       | string\|array         | Additional skill directories                                                                                                                              | `"./custom/skills/"`                   |&para;<br>| `hooks`        | string\|array\|object | Hook config paths or inline config                                                                                                                        | `"./my-extra-hooks.json"`              |&para;<br>| `mcpServers`   | string\|array\|object | MCP config paths or inline config                                                                                                                         | `"./my-extra-mcp-config.json"`         |&para;<br>| `outputStyles` | string\|array         | Additional output style files/directories                                                                                                                 | `"./styles/"`                          |&para;<br>| `lspServers`   | string\|array\|object | [Language Server Protocol](https://microsoft.github.io/language-server-protocol/) configs for code intelligence (go to definition, find references, etc.) | `"./.lsp.json"`                        |&para;<br>&para;<br>### Path behavior rules&para;<br>&para;<br>**Important**: Custom paths supplement default directories - they don't replace them.&para;<br>&para;<br>* If `commands/` exists, it's loaded in addition to custom command paths&para;<br>* All paths must be relative to plugin root and start with `./`&para;<br>* Commands from custom paths use the same naming and namespacing rules&para;<br>* Multiple paths can be specified as arrays for flexibility&para;<br>&para;<br>**Path examples**:&para;<br>&para;<br>```json  theme={null}&para;<br>{&para;<br>  "commands": [&para;<br>    "./specialized/deploy.md",&para;<br>    "./utilities/batch-process.md"&para;<br>  ],&para;<br>  "agents": [&para;<br>    "./custom-agents/reviewer.md",&para;<br>    "./custom-agents/tester.md"&para;<br>  ]&para;<br>}&para;<br>```&para;<br>&para;<br>### Environment variables&para;<br>&para;<br>**`${CLAUDE_PLUGIN_ROOT}`**: Contains the absolute path to your plugin directory. Use this in hooks, MCP servers, and scripts to ensure correct paths regardless of installation location.&para;<br>&para;<br>```json  theme={null}&para;<br>{&para;<br>  "hooks": {&para;<br>    "PostToolUse": [&para;<br>      {&para;<br>        "hooks": [&para;<br>          {&para;<br>            "type": "command",&para;<br>            "command": "${CLAUDE_PLUGIN_ROOT}/scripts/process.sh"&para;<br>          }&para;<br>        ]&para;<br>      }&para;<br>    ]&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>***&para;<br>&para;<br>## Plugin caching and file resolution&para;<br>&para;<br>Plugins are specified in one of two ways:&para;<br>&para;<br>* Through `claude --plugin-dir`, for the duration of a session.&para;<br>* Through a marketplace, installed for future sessions.&para;<br>&para;<br>For security and verification purposes, Claude Code copies *marketplace* plugins to the user's local **plugin cache** (`~/.claude/plugins/cache`) rather than using them in-place. Understanding this behavior is important when developing plugins that reference external files.&para;<br>&para;<br>### Path traversal limitations&para;<br>&para;<br>Installed plugins cannot reference files outside their directory. Paths that traverse outside the plugin root (such as `../shared-utils`) will not work after installation because those external files are not copied to the cache.&para;<br>&para;<br>### Working with external dependencies&para;<br>&para;<br>If your plugin needs to access files outside its directory, you can create symbolic links to external files within your plugin directory. Symlinks are honored during the copy process:&para;<br>&para;<br>```bash  theme={null}&para;<br># Inside your plugin directory&para;<br>ln -s /path/to/shared-utils ./shared-utils&para;<br>```&para;<br>&para;<br>The symlinked content will be copied into the plugin cache. This provides flexibility while maintaining the security benefits of the caching system.&para;<br>&para;<br>***&para;<br>&para;<br>## Plugin directory structure&para;<br>&para;<br>### Standard plugin layout&para;<br>&para;<br>A complete plugin follows this structure:&para;<br>&para;<br>```</span><ins style="background:#e6ffe6;">text  theme={null}</ins><span>&para;<br>enterprise-plugin/&para;<br>├── .claude-plugin/           # Metadata directory (optional)&para;<br>│   └── plugin.json             # plugin manifest&para;<br>├── commands/                 # Default command location&para;<br>│   ├── status.md&para;<br>│   └── logs.md&para;<br>├── agents/                   # Default agent location&para;<br>│   ├── security-reviewer.md&para;<br>│   ├── performance-tester.md&para;<br>│   └── compliance-checker.md&para;<br>├── skills/                   # Agent Skills&para;<br>│   ├── code-reviewer/&para;<br>│   │   └── SKILL.md&para;<br>│   └── pdf-processor/&para;<br>│       ├── SKILL.md&para;<br>│       └── scripts/&para;<br>├── hooks/                    # Hook configurations&para;<br>│   ├── hooks.json           # Main hook config&para;<br>│   └── security-hooks.json  # Additional hooks&para;<br>├── settings.json            # Default settings for the plugin&para;<br>├── .mcp.json                # MCP server definitions&para;<br>├── .lsp.json                # LSP server configurations&para;<br>├── scripts/                 # Hook and utility scripts&para;<br>│   ├── security-scan.sh&para;<br>│   ├── format-code.py&para;<br>│   └── deploy.js&para;<br>├── LICENSE                  # License file&para;<br>└── CHANGELOG.md             # Version history&para;<br>```&para;<br>&para;<br>&lt;Warning&gt;&para;<br>  The `.claude-plugin/` directory contains the `plugin.json` file. All other directories (commands/, agents/, skills/, hooks/) must be at the plugin root, not inside `.claude-plugin/`.&para;<br>&lt;/Warning&gt;&para;<br>&para;<br>### File locations reference&para;<br>&para;<br>| Component       | Default Location             | Purpose                                                                                                                   |&para;<br>| :-------------- | :--------------------------- | :------------------------------------------------------------------------------------------------------------------------ |&para;<br>| **Manifest**    | `.claude-plugin/plugin.json` | Plugin metadata and configuration (optional)                                                                              |&para;<br>| **Commands**    | `commands/`                  | Skill Markdown files (legacy; use `skills/` for new skills)                                                               |&para;<br>| **Agents**      | `agents/`                    | Subagent Markdown files                                                                                                   |&para;<br>| **Skills**      | `skills/`                    | Skills with `&lt;name&gt;/SKILL.md` structure                                                                                   |&para;<br>| **Hooks**       | `hooks/hooks.json`           | Hook configuration                                                                                                        |&para;<br>| **MCP servers** | `.mcp.json`                  | MCP server definitions                                                                                                    |&para;<br>| **LSP servers** | `.lsp.json`                  | Language server configurations                                                                                            |&para;<br>| **Settings**    | `settings.json`              | Default configuration applied when the plugin is enabled. Only [`agent`](/en/sub-agents) settings are currently supported |&para;<br>&para;<br>***&para;<br>&para;<br>## CLI commands reference&para;<br>&para;<br>Claude Code provides CLI commands for non-interactive plugin management, useful for scripting and automation.&para;<br>&para;<br>### plugin install&para;<br>&para;<br>Install a plugin from available marketplaces.&para;<br>&para;<br>```bash  theme={null}&para;<br>claude plugin install &lt;plugin&gt; [options]&para;<br>```&para;<br>&para;<br>**Arguments:**&para;<br>&para;<br>* `&lt;plugin&gt;`: Plugin name or `plugin-name@marketplace-name` for a specific marketplace&para;<br>&para;<br>**Options:**&para;<br>&para;<br>| Option                | Description                                       | Default |&para;<br>| :-------------------- | :------------------------------------------------ | :------ |&para;<br>| `-s, --scope &lt;scope&gt;` | Installation scope: `user`, `project`, or `local` | `user`  |&para;<br>| `-h, --help`          | Display help for command                          |         |&para;<br>&para;<br>Scope determines which settings file the installed plugin is added to. For example, --scope project writes to `enabledPlugins` in .claude/settings.json, making the plugin available to everyone who clones the project repository.&para;<br>&para;<br>**Examples:**&para;<br>&para;<br>```bash  theme={null}&para;<br># Install to user scope (default)&para;<br>claude plugin install formatter@my-marketplace&para;<br>&para;<br># Install to project scope (shared with team)&para;<br>claude plugin install formatter@my-marketplace --scope project&para;<br>&para;<br># Install to local scope (gitignored)&para;<br>claude plugin install formatter@my-marketplace --scope local&para;<br>```&para;<br>&para;<br>### plugin uninstall&para;<br>&para;<br>Remove an installed plugin.&para;<br>&para;<br>```bash  theme={null}&para;<br>claude plugin uninstall &lt;plugin&gt; [options]&para;<br>```&para;<br>&para;<br>**Arguments:**&para;<br>&para;<br>* `&lt;plugin&gt;`: Plugin name or `plugin-name@marketplace-name`&para;<br>&para;<br>**Options:**&para;<br>&para;<br>| Option                | Description                                         | Default |&para;<br>| :-------------------- | :-------------------------------------------------- | :------ |&para;<br>| `-s, --scope &lt;scope&gt;` | Uninstall from scope: `user`, `project`, or `local` | `user`  |&para;<br>| `-h, --help`          | Display help for command                            |         |&para;<br>&para;<br>**Aliases:** `remove`, `rm`&para;<br>&para;<br>### plugin enable&para;<br>&para;<br>Enable a disabled plugin.&para;<br>&para;<br>```bash  theme={null}&para;<br>claude plugin enable &lt;plugin&gt; [options]&para;<br>```&para;<br>&para;<br>**Arguments:**&para;<br>&para;<br>* `&lt;plugin&gt;`: Plugin name or `plugin-name@marketplace-name`&para;<br>&para;<br>**Options:**&para;<br>&para;<br>| Option                | Description                                    | Default |&para;<br>| :-------------------- | :--------------------------------------------- | :------ |&para;<br>| `-s, --scope &lt;scope&gt;` | Scope to enable: `user`, `project`, or `local` | `user`  |&para;<br>| `-h, --help`          | Display help for command                       |         |&para;<br>&para;<br>### plugin disable&para;<br>&para;<br>Disable a plugin without uninstalling it.&para;<br>&para;<br>```bash  theme={null}&para;<br>claude plugin disable &lt;plugin&gt; [options]&para;<br>```&para;<br>&para;<br>**Arguments:**&para;<br>&para;<br>* `&lt;plugin&gt;`: Plugin name or `plugin-name@marketplace-name`&para;<br>&para;<br>**Options:**&para;<br>&para;<br>| Option                | Description                                     | Default |&para;<br>| :-------------------- | :---------------------------------------------- | :------ |&para;<br>| `-s, --scope &lt;scope&gt;` | Scope to disable: `user`, `project`, or `local` | `user`  |&para;<br>| `-h, --help`          | Display help for command                        |         |&para;<br>&para;<br>### plugin update&para;<br>&para;<br>Update a plugin to the latest version.&para;<br>&para;<br>```bash  theme={null}&para;<br>claude plugin update &lt;plugin&gt; [options]&para;<br>```&para;<br>&para;<br>**Arguments:**&para;<br>&para;<br>* `&lt;plugin&gt;`: Plugin name or `plugin-name@marketplace-name`&para;<br>&para;<br>**Options:**&para;<br>&para;<br>| Option                | Description                                               | Default |&para;<br>| :-------------------- | :-------------------------------------------------------- | :------ |&para;<br>| `-s, --scope &lt;scope&gt;` | Scope to update: `user`, `project`, `local`, or `managed` | `user`  |&para;<br>| `-h, --help`          | Display help for command                                  |         |&para;<br>&para;<br>***&para;<br>&para;<br>## Debugging and development tools&para;<br>&para;<br>### Debugging commands&para;<br>&para;<br>Use `claude --debug` (or `/debug` within the TUI) to see plugin loading details:&para;<br>&para;<br>This shows:&para;<br>&para;<br>* Which plugins are being loaded&para;<br>* Any errors in plugin manifests&para;<br>* Command, agent, and hook registration&para;<br>* MCP server initialization&para;<br>&para;<br>### Common issues&para;<br>&para;<br>| Issue                               | Cause                           | Solution                                                                          |&para;<br>| :---------------------------------- | :------------------------------ | :-------------------------------------------------------------------------------- |&para;<br>| Plugin not loading                  | Invalid `plugin.json`           | Validate JSON syntax with `claude plugin validate` or `/plugin validate`          |&para;<br>| Commands not appearing              | Wrong directory structure       | Ensure `commands/` at root, not in `.claude-plugin/`                              |&para;<br>| Hooks not firing                    | Script not executable           | Run `chmod +x script.sh`                                                          |&para;<br>| MCP server fails                    | Missing `${CLAUDE_PLUGIN_ROOT}` | Use variable for all plugin paths                                                 |&para;<br>| Path errors                         | Absolute paths used             | All paths must be relative and start with `./`                                    |&para;<br>| LSP `Executable not found in $PATH` | Language server not installed   | Install the binary (e.g., `npm install -g typescript-language-server typescript`) |&para;<br>&para;<br>### Example error messages&para;<br>&para;<br>**Manifest validation errors**:&para;<br>&para;<br>* `Invalid JSON syntax: Unexpected token } in JSON at position 142`: check for missing commas, extra commas, or unquoted strings&para;<br>* `Plugin has an invalid manifest file at .claude-plugin/plugin.json. Validation errors: name: Required`: a required field is missing&para;<br>* `Plugin has a corrupt manifest file at .claude-plugin/plugin.json. JSON parse error: ...`: JSON syntax error&para;<br>&para;<br>**Plugin loading errors**:&para;<br>&para;<br>* `Warning: No commands found in plugin my-plugin custom directory: ./cmds. Expected .md files or SKILL.md in subdirectories.`: command path exists but contains no valid command files&para;<br>* `Plugin directory not found at path: ./plugins/my-plugin. Check that the marketplace entry has the correct path.`: the `source` path in marketplace.json points to a non-existent directory&para;<br>* `Plugin my-plugin has conflicting manifests: both plugin.json and marketplace entry specify components.`: remove duplicate component definitions or remove `strict: false` in marketplace entry&para;<br>&para;<br>### Hook troubleshooting&para;<br>&para;<br>**Hook script not executing**:&para;<br>&para;<br>1. Check the script is executable: `chmod +x ./scripts/your-script.sh`&para;<br>2. Verify the shebang line: First line should be `#!/bin/bash` or `#!/usr/bin/env bash`&para;<br>3. Check the path uses `${CLAUDE_PLUGIN_ROOT}`: `"command": "${CLAUDE_PLUGIN_ROOT}/scripts/your-script.sh"`&para;<br>4. Test the script manually: `./scripts/your-script.sh`&para;<br>&para;<br>**Hook not triggering on expected events**:&para;<br>&para;<br>1. Verify the event name is correct (case-sensitive): `PostToolUse`, not `postToolUse`&para;<br>2. Check the matcher pattern matches your tools: `"matcher": "Write|Edit"` for file operations&para;<br>3. Confirm the hook type is valid: `command`, `prompt`, or `agent`&para;<br>&para;<br>### MCP server troubleshooting&para;<br>&para;<br>**Server not starting**:&para;<br>&para;<br>1. Check the command exists and is executable&para;<br>2. Verify all paths use `${CLAUDE_PLUGIN_ROOT}` variable&para;<br>3. Check the MCP server logs: `claude --debug` shows initialization errors&para;<br>4. Test the server manually outside of Claude Code&para;<br>&para;<br>**Server tools not appearing**:&para;<br>&para;<br>1. Ensure the server is properly configured in `.mcp.json` or `plugin.json`&para;<br>2. Verify the server implements the MCP protocol correctly&para;<br>3. Check for connection timeouts in debug output&para;<br>&para;<br>### Directory structure mistakes&para;<br>&para;<br>**Symptoms**: Plugin loads but components (commands, agents, hooks) are missing.&para;<br>&para;<br>**Correct structure**: Components must be at the plugin root, not inside `.claude-plugin/`. Only `plugin.json` belongs in `.claude-plugin/`.&para;<br>&para;<br>```</span><ins style="background:#e6ffe6;">text  theme={null}</ins><span>&para;<br>my-plugin/&para;<br>├── .claude-plugin/&para;<br>│   └── plugin.json      ← Only manifest here&para;<br>├── commands/            ← At root level&para;<br>├── agents/              ← At root level&para;<br>└── hooks/               ← At root level&para;<br>```&para;<br>&para;<br>If your components are inside `.claude-plugin/`, move them to the plugin root.&para;<br>&para;<br>**Debug checklist**:&para;<br>&para;<br>1. Run `claude --debug` and look for "loading plugin" messages&para;<br>2. Check that each component directory is listed in the debug output&para;<br>3. Verify file permissions allow reading the plugin files&para;<br>&para;<br>***&para;<br>&para;<br>## Distribution and versioning reference&para;<br>&para;<br>### Version management&para;<br>&para;<br>Follow semantic versioning for plugin releases:&para;<br>&para;<br>```json  theme={null}&para;<br>{&para;<br>  "name": "my-plugin",&para;<br>  "version": "2.1.0"&para;<br>}&para;<br>```&para;<br>&para;<br>**Version format**: `MAJOR.MINOR.PATCH`&para;<br>&para;<br>* **MAJOR**: Breaking changes (incompatible API changes)&para;<br>* **MINOR**: New features (backward-compatible additions)&para;<br>* **PATCH**: Bug fixes (backward-compatible fixes)&para;<br>&para;<br>**Best practices**:&para;<br>&para;<br>* Start at `1.0.0` for your first stable release&para;<br>* Update the version in `plugin.json` before distributing changes&para;<br>* Document changes in a `CHANGELOG.md` file&para;<br>* Use pre-release versions like `2.0.0-beta.1` for testing&para;<br>&para;<br>&lt;Warning&gt;&para;<br>  Claude Code uses the version to determine whether to update your plugin. If you change your plugin's code but don't bump the version in `plugin.json`, your plugin's existing users won't see your changes due to caching.&para;<br>&para;<br>  If your plugin is within a [marketplace](/en/plugin-marketplaces) directory, you can manage the version through `marketplace.json` instead and omit the `version` field from `plugin.json`.&para;<br>&lt;/Warning&gt;&para;<br>&para;<br>***&para;<br>&para;<br>## See also&para;<br>&para;<br>* [Plugins](/en/plugins) - Tutorials and practical usage&para;<br>* [Plugin marketplaces](/en/plugin-marketplaces) - Creating and managing marketplaces&para;<br>* [Skills](/en/skills) - Skill development details&para;<br>* [Subagents](/en/sub-agents) - Agent configuration and capabilities&para;<br>* [Hooks](/en/hooks) - Event handling and automation&para;<br>* [MCP](/en/mcp) - External tool integration&para;<br>* [Settings](/en/settings) - Configuration options for plugins&para;<br></span></div>
        </div>

        <h2 style="margin-top: 2rem; margin-bottom: 1rem;">Unified Diff</h2>
        <pre><code>--- a/plugins-reference.md
+++ b/plugins-reference.md
@@ -26,7 +26,7 @@
 
 **Skill structure**:
 
-```
+```text  theme={null}
 skills/
 ├── pdf-processor/
 │   ├── SKILL.md
@@ -408,7 +408,7 @@
 
 A complete plugin follows this structure:
 
-```
+```text  theme={null}
 enterprise-plugin/
 ├── .claude-plugin/           # Metadata directory (optional)
 │   └── plugin.json             # plugin manifest
@@ -650,7 +650,7 @@
 
 **Correct structure**: Components must be at the plugin root, not inside `.claude-plugin/`. Only `plugin.json` belongs in `.claude-plugin/`.
 
-```
+```text  theme={null}
 my-plugin/
 ├── .claude-plugin/
 │   └── plugin.json      ← Only manifest here
</code></pre>
    </div>
</body>
</html>