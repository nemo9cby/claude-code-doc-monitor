<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>google-vertex-ai - Diff Report</title>
    <link rel="stylesheet" href="../../css/diff.css">
    <style>
        :root {
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --text-color: #eee;
            --accent: #0f3460;
            --add-bg: #1a4d1a;
            --del-bg: #4d1a1a;
            --add-text: #4ade80;
            --del-text: #f87171;
        }
        @media (prefers-color-scheme: light) {
            :root {
                --bg-color: #f5f5f5;
                --card-bg: #fff;
                --text-color: #333;
                --accent: #e0e0e0;
                --add-bg: #d4edda;
                --del-bg: #f8d7da;
                --add-text: #155724;
                --del-text: #721c24;
            }
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 2rem;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { margin-bottom: 2rem; }
        h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .meta { color: #888; font-size: 0.9rem; }
        .summary {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            display: flex;
            gap: 2rem;
        }
        .stat { display: flex; align-items: center; gap: 0.5rem; }
        .stat.added { color: var(--add-text); }
        .stat.removed { color: var(--del-text); }
        .analysis {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border-left: 4px solid #8b5cf6;
        }
        .analysis-header {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #8b5cf6;
        }
        .analysis-content {
            white-space: pre-wrap;
            font-size: 0.95rem;
            line-height: 1.7;
        }
        .diff-container {
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
        }
        .diff-header {
            background: var(--accent);
            padding: 0.75rem 1rem;
            font-weight: 600;
        }
        .diff-content {
            padding: 1rem;
            overflow-x: auto;
        }
        .diff-content ins {
            background: var(--add-bg);
            color: var(--add-text);
            text-decoration: none;
            padding: 0.1em 0.2em;
            border-radius: 2px;
        }
        .diff-content del {
            background: var(--del-bg);
            color: var(--del-text);
            text-decoration: line-through;
            padding: 0.1em 0.2em;
            border-radius: 2px;
        }
        pre {
            background: var(--accent);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
            margin-top: 2rem;
        }
        a { color: #60a5fa; }
        .back-link { margin-bottom: 1rem; display: inline-block; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">&larr; Back to daily report</a>

        <header>
            <h1>google-vertex-ai.md</h1>
            <p class="meta">Changed on 2026-02-03 20:41:54 EST</p>
        </header>

        <div class="summary">
            <div class="stat added">
                <span>+2</span> lines added
            </div>
            <div class="stat removed">
                <span>-2</span> lines removed
            </div>
        </div>

        

        <div class="diff-container">
            <div class="diff-header">Visual Diff</div>
            <div class="diff-content"><span>&gt; ## Documentation Index&para;<br>&gt; Fetch the complete documentation index at: https://code.claude.com/docs/llms.txt&para;<br>&gt; Use this file to discover all available pages before exploring further.&para;<br>&para;<br># Claude Code on Google Vertex AI&para;<br>&para;<br>&gt; Learn about configuring Claude Code through Google Vertex AI, including setup, IAM configuration, and troubleshooting.&para;<br>&para;<br>## Prerequisites&para;<br>&para;<br>Before configuring Claude Code with Vertex AI, ensure you have:&para;<br>&para;<br>* A Google Cloud Platform (GCP) account with billing enabled&para;<br>* A GCP project with Vertex AI API enabled&para;<br>* Access to desired Claude models (for example, Claude Sonnet 4.5)&para;<br>* Google Cloud SDK (`gcloud`) installed and configured&para;<br>* Quota allocated in desired GCP region&para;<br>&para;<br>## Region Configuration&para;<br>&para;<br>Claude Code can be used with both Vertex AI [global](https://cloud.google.com/blog/products/ai-machine-learning/global-endpoint-for-claude-models-generally-available-on-vertex-ai) and regional endpoints.&para;<br>&para;<br>&lt;Note&gt;&para;<br>  Vertex AI may not support the Claude Code default models on all regions. You may need to switch to a [supported region or model](https://cloud.google.com/vertex-ai/generative-ai/docs/learn/locations#genai-partner-models).&para;<br>&lt;/Note&gt;&para;<br>&para;<br>&lt;Note&gt;&para;<br>  Vertex AI may not support the Claude Code default models on global endpoints. You may need to switch to a regional endpoint or [supported model](https://cloud.google.com/vertex-ai/generative-ai/docs/partner-models/use-partner-models#supported_models).&para;<br>&lt;/Note&gt;&para;<br>&para;<br>## Setup&para;<br>&para;<br>### 1. Enable Vertex AI API&para;<br>&para;<br>Enable the Vertex AI API in your GCP project:&para;<br>&para;<br>```bash  theme={null}&para;<br># Set your project ID&para;<br>gcloud config set project YOUR-PROJECT-ID&para;<br>&para;<br># Enable Vertex AI API&para;<br>gcloud services enable aiplatform.googleapis.com&para;<br>```&para;<br>&para;<br>### 2. Request model access&para;<br>&para;<br>Request access to Claude models in Vertex AI:&para;<br>&para;<br>1. Navigate to the [Vertex AI Model Garden](https://console.cloud.google.com/vertex-ai/model-garden)&para;<br>2. Search for "Claude" models&para;<br>3. Request access to desired Claude models (for example, Claude Sonnet 4.5)&para;<br>4. Wait for approval (may take 24-48 hours)&para;<br>&para;<br>### 3. Configure GCP credentials&para;<br>&para;<br>Claude Code uses standard Google Cloud authentication.&para;<br>&para;<br>For more information, see [Google Cloud authentication documentation](https://cloud.google.com/docs/authentication).&para;<br>&para;<br>&lt;Note&gt;&para;<br>  When authenticating, Claude Code will automatically use the project ID from the `ANTHROPIC_VERTEX_PROJECT_ID` environment variable. To override this, set one of these environment variables: `GCLOUD_PROJECT`, `GOOGLE_CLOUD_PROJECT`, or `GOOGLE_APPLICATION_CREDENTIALS`.&para;<br>&lt;/Note&gt;&para;<br>&para;<br>### 4. Configure Claude Code&para;<br>&para;<br>Set the following environment variables:&para;<br>&para;<br>```bash  theme={null}&para;<br># Enable Vertex AI integration&para;<br>export CLAUDE_CODE_USE_VERTEX=1&para;<br>export CLOUD_ML_REGION=global&para;<br>export ANTHROPIC_VERTEX_PROJECT_ID=YOUR-PROJECT-ID&para;<br>&para;<br># Optional: Disable prompt caching if needed&para;<br>export DISABLE_PROMPT_CACHING=1&para;<br>&para;<br># When CLOUD_ML_REGION=global, override region for unsupported models&para;<br>export VERTEX_REGION_CLAUDE_3_5_HAIKU=us-east5&para;<br>&para;<br># Optional: Override regions for other specific models&para;<br>export VERTEX_REGION_CLAUDE_3_5_SONNET=us-east5&para;<br>export VERTEX_REGION_CLAUDE_3_7_SONNET=us-east5&para;<br>export VERTEX_REGION_CLAUDE_4_0_OPUS=europe-west1&para;<br>export VERTEX_REGION_CLAUDE_4_0_SONNET=us-east5&para;<br>export VERTEX_REGION_CLAUDE_4_1_OPUS=europe-west1&para;<br>```&para;<br>&para;<br>&lt;Note&gt;&para;<br>  [Prompt caching](https://</span><del style="background:#ffe6e6;">docs</del><ins style="background:#e6ffe6;">platform</ins><span>.claude.com/</span><del style="background:#ffe6e6;">en/</del><span>docs/</span><ins style="background:#e6ffe6;">en/</ins><span>build-with-claude/prompt-caching) is automatically supported when you specify the `cache_control` ephemeral flag. To disable it, set `DISABLE_PROMPT_CACHING=1`. For heightened rate limits, contact Google Cloud support.&para;<br>&lt;/Note&gt;&para;<br>&para;<br>&lt;Note&gt;&para;<br>  When using Vertex AI, the `/login` and `/logout` commands are disabled since authentication is handled through Google Cloud credentials.&para;<br>&lt;/Note&gt;&para;<br>&para;<br>### 5. Model configuration&para;<br>&para;<br>Claude Code uses these default models for Vertex AI:&para;<br>&para;<br>| Model type       | Default value                |&para;<br>| :--------------- | :--------------------------- |&para;<br>| Primary model    | `claude-sonnet-4-5@20250929` |&para;<br>| Small/fast model | `claude-haiku-4-5@20251001`  |&para;<br>&para;<br>&lt;Note&gt;&para;<br>  For Vertex AI users, Claude Code will not automatically upgrade from Haiku 3.5 to Haiku 4.5. To manually switch to a newer Haiku model, set the `ANTHROPIC_DEFAULT_HAIKU_MODEL` environment variable to the full model name (for example, `claude-haiku-4-5@20251001`).&para;<br>&lt;/Note&gt;&para;<br>&para;<br>To customize models:&para;<br>&para;<br>```bash  theme={null}&para;<br>export ANTHROPIC_MODEL='claude-opus-4-1@20250805'&para;<br>export ANTHROPIC_SMALL_FAST_MODEL='claude-haiku-4-5@20251001'&para;<br>```&para;<br>&para;<br>## IAM configuration&para;<br>&para;<br>Assign the required IAM permissions:&para;<br>&para;<br>The `roles/aiplatform.user` role includes the required permissions:&para;<br>&para;<br>* `aiplatform.endpoints.predict` - Required for model invocation and token counting&para;<br>&para;<br>For more restrictive permissions, create a custom role with only the permissions above.&para;<br>&para;<br>For details, see [Vertex IAM documentation](https://cloud.google.com/vertex-ai/docs/general/access-control).&para;<br>&para;<br>&lt;Note&gt;&para;<br>  We recommend creating a dedicated GCP project for Claude Code to simplify cost tracking and access control.&para;<br>&lt;/Note&gt;&para;<br>&para;<br>## 1M token context window&para;<br>&para;<br>Claude Sonnet 4 and Sonnet 4.5 support the [1M token context window](https://</span><del style="background:#ffe6e6;">docs</del><ins style="background:#e6ffe6;">platform</ins><span>.claude.com/</span><del style="background:#ffe6e6;">en/</del><span>docs/</span><ins style="background:#e6ffe6;">en/</ins><span>build-with-claude/context-windows#1m-token-context-window) on Vertex AI.&para;<br>&para;<br>&lt;Note&gt;&para;<br>  The 1M token context window is currently in beta. To use the extended context window, include the `context-1m-2025-08-07` beta header in your Vertex AI requests.&para;<br>&lt;/Note&gt;&para;<br>&para;<br>## Troubleshooting&para;<br>&para;<br>If you encounter quota issues:&para;<br>&para;<br>* Check current quotas or request quota increase through [Cloud Console](https://cloud.google.com/docs/quotas/view-manage)&para;<br>&para;<br>If you encounter "model not found" 404 errors:&para;<br>&para;<br>* Confirm model is Enabled in [Model Garden](https://console.cloud.google.com/vertex-ai/model-garden)&para;<br>* Verify you have access to the specified region&para;<br>* If using `CLOUD_ML_REGION=global`, check that your models support global endpoints in [Model Garden](https://console.cloud.google.com/vertex-ai/model-garden) under "Supported features". For models that don't support global endpoints, either:&para;<br>  * Specify a supported model via `ANTHROPIC_MODEL` or `ANTHROPIC_SMALL_FAST_MODEL`, or&para;<br>  * Set a regional endpoint using `VERTEX_REGION_&lt;MODEL_NAME&gt;` environment variables&para;<br>&para;<br>If you encounter 429 errors:&para;<br>&para;<br>* For regional endpoints, ensure the primary model and small/fast model are supported in your selected region&para;<br>* Consider switching to `CLOUD_ML_REGION=global` for better availability&para;<br>&para;<br>## Additional resources&para;<br>&para;<br>* [Vertex AI documentation](https://cloud.google.com/vertex-ai/docs)&para;<br>* [Vertex AI pricing](https://cloud.google.com/vertex-ai/pricing)&para;<br>* [Vertex AI quotas and limits](https://cloud.google.com/vertex-ai/docs/quotas)&para;<br></span></div>
        </div>

        <h2 style="margin-top: 2rem; margin-bottom: 1rem;">Unified Diff</h2>
        <pre><code>--- a/google-vertex-ai.md
+++ b/google-vertex-ai.md
@@ -86,7 +86,7 @@
 ```
 
 &lt;Note&gt;
-  [Prompt caching](https://docs.claude.com/en/docs/build-with-claude/prompt-caching) is automatically supported when you specify the `cache_control` ephemeral flag. To disable it, set `DISABLE_PROMPT_CACHING=1`. For heightened rate limits, contact Google Cloud support.
+  [Prompt caching](https://platform.claude.com/docs/en/build-with-claude/prompt-caching) is automatically supported when you specify the `cache_control` ephemeral flag. To disable it, set `DISABLE_PROMPT_CACHING=1`. For heightened rate limits, contact Google Cloud support.
 &lt;/Note&gt;
 
 &lt;Note&gt;
@@ -131,7 +131,7 @@
 
 ## 1M token context window
 
-Claude Sonnet 4 and Sonnet 4.5 support the [1M token context window](https://docs.claude.com/en/docs/build-with-claude/context-windows#1m-token-context-window) on Vertex AI.
+Claude Sonnet 4 and Sonnet 4.5 support the [1M token context window](https://platform.claude.com/docs/en/build-with-claude/context-windows#1m-token-context-window) on Vertex AI.
 
 &lt;Note&gt;
   The 1M token context window is currently in beta. To use the extended context window, include the `context-1m-2025-08-07` beta header in your Vertex AI requests.
</code></pre>
    </div>
</body>
</html>