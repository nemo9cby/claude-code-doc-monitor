<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>about-claude/models/migrating-to-claude-4 - Diff Report</title>
    <link rel="stylesheet" href="../../css/diff.css">
    <style>
        :root {
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --text-color: #eee;
            --accent: #0f3460;
            --add-bg: #1a4d1a;
            --del-bg: #4d1a1a;
            --add-text: #4ade80;
            --del-text: #f87171;
        }
        @media (prefers-color-scheme: light) {
            :root {
                --bg-color: #f5f5f5;
                --card-bg: #fff;
                --text-color: #333;
                --accent: #e0e0e0;
                --add-bg: #d4edda;
                --del-bg: #f8d7da;
                --add-text: #155724;
                --del-text: #721c24;
            }
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 2rem;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { margin-bottom: 2rem; }
        h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .meta { color: #888; font-size: 0.9rem; }
        .summary {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            display: flex;
            gap: 2rem;
        }
        .stat { display: flex; align-items: center; gap: 0.5rem; }
        .stat.added { color: var(--add-text); }
        .stat.removed { color: var(--del-text); }
        .analysis {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border-left: 4px solid #8b5cf6;
        }
        .analysis-header {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #8b5cf6;
        }
        .analysis-content {
            white-space: pre-wrap;
            font-size: 0.95rem;
            line-height: 1.7;
        }
        .diff-container {
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
        }
        .diff-header {
            background: var(--accent);
            padding: 0.75rem 1rem;
            font-weight: 600;
        }
        .diff-content {
            padding: 1rem;
            overflow-x: auto;
        }
        .diff-content ins {
            background: var(--add-bg);
            color: var(--add-text);
            text-decoration: none;
            padding: 0.1em 0.2em;
            border-radius: 2px;
        }
        .diff-content del {
            background: var(--del-bg);
            color: var(--del-text);
            text-decoration: line-through;
            padding: 0.1em 0.2em;
            border-radius: 2px;
        }
        pre {
            background: var(--accent);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
            margin-top: 2rem;
        }
        a { color: #60a5fa; }
        .back-link { margin-bottom: 1rem; display: inline-block; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../../index.html" class="back-link">&larr; Back to daily report</a>

        <header>
            <h1>about-claude/models/migrating-to-claude-4.md</h1>
            <p class="meta">Changed on 2026-02-05 17:22:25 EST</p>
        </header>

        <div class="summary">
            <div class="stat added">
                <span>+38</span> lines added
            </div>
            <div class="stat removed">
                <span>-44</span> lines removed
            </div>
        </div>

        

        <div class="diff-container">
            <div class="diff-header">Visual Diff</div>
            <div class="diff-content"><span># Migration guide&para;<br>&para;<br>Guide for migrating to Claude 4.6 models from previous Claude versions&para;<br>&para;<br>---&para;<br>&para;<br>## Migrating to Claude 4.6&para;<br>&para;<br>Claude Opus 4.6 is a near drop-in replacement for Claude 4.5, with a few breaking changes to be aware of. For a full list of new features, see [What's new in Claude 4.6](/docs/en/about-claude/models/whats-new-claude-4-6).&para;<br>&para;<br>### Update your model name&para;<br>&para;<br>```python&para;<br># Opus migration&para;<br>model="claude-opus-4-5"   </span><del style="background:#ffe6e6;">  </del><span># Before&para;<br>model="claude-opus-4-6"</span><del style="background:#ffe6e6;">    </del><span>   # After&para;<br>```&para;<br>&para;<br>### Breaking changes&para;<br>&para;<br>1. **Prefill removal</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Prefilling assistant messages returns a 400 error on Claude 4.6 models. Use [structured outputs](/docs/en/build-with-claude/structured-outputs), system prompt instructions, or `output_config.format` instead.&para;<br>&para;<br>2. **Tool parameter quoting</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Claude 4.6 models may produce slightly different JSON string escaping in tool call arguments (e.g., different handling of Unicode escapes or forward slash escaping). If you parse tool call `input` as a raw string rather than using a JSON parser, verify your parsing logic. Standard JSON parsers (like `json.loads()` or `JSON.parse()`) handle these differences automatically.&para;<br>&para;<br>### Recommended changes&para;<br>&para;<br>These are not required but will improve your experience:&para;<br>&para;<br>1. **Migrate to adaptive thinking</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> `thinking: {type: "enabled", budget_tokens: N}` is deprecated on Claude 4.6 models and will be removed in a future model release. Switch to `thinking: {type: "adaptive"}` and use the [effort parameter](/docs/en/build-with-claude/effort) to control thinking depth. See [Adaptive thinking](/docs/en/build-with-claude/adaptive-thinking).&para;<br>&para;<br>   &lt;CodeGroup&gt;&para;<br>   ```python Before&para;<br>   response = client.beta.messages.create(&para;<br>       model="claude-opus-4-5",&para;<br>       max_tokens=16000,&para;<br>       thinking={&para;<br>           "type": "enabled",&para;<br>           "budget_tokens": 32000&para;<br>       },&para;<br>       betas=["interleaved-thinking-2025-05-14"],&para;<br>       messages=[...]&para;<br>   )&para;<br>   ```&para;<br>&para;<br>   ```python After&para;<br>   response = client.messages.create(&para;<br>       model="claude-opus-4-6",&para;<br>       max_tokens=16000,&para;<br>       thinking={&para;<br>           "type": "adaptive"&para;<br>       },&para;<br>       output_config={&para;<br>           "effort": "high"&para;<br>       },&para;<br>       messages=[...]&para;<br>   )&para;<br>   ```&para;<br>   &lt;/CodeGroup&gt;&para;<br>&para;<br>   Note that the migration also moves from `client.beta.messages.create` to `client.messages.create`</span><del style="background:#ffe6e6;"> — a</del><ins style="background:#e6ffe6;">. A</ins><span>daptive thinking and effort are GA features and do not require the beta SDK namespace or any beta headers.&para;<br>&para;<br>2. **Remove effort beta header</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> The effort parameter is now GA. Remove `betas=["effort-2025-11-24"]` from your requests.&para;<br>&para;<br>3. **Remove fine-grained tool streaming beta header</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Fine-grained tool streaming is now GA. Remove `betas=["fine-grained-tool-streaming-2025-05-14"]` from your requests.&para;<br>&para;<br>4. **Remove interleaved thinking beta header</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Adaptive thinking automatically enables interleaved thinking. Remove `betas=["interleaved-thinking-2025-05-14"]` from your requests.&para;<br>&para;<br>5. **Migrate to output_config.format</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> If using structured outputs, update `output_format={...}` to `output_config={"format": {...}}`. The old parameter remains functional but is deprecated and will be removed in a future model release.&para;<br>&para;<br>### Migrating from Claude 4.1 or earlier to Claude 4.6&para;<br>&para;<br>If you're migrating from Opus 4.1, Sonnet 4, or earlier models directly to Claude 4.6, apply the Claude 4.6 breaking changes above plus the additional changes in this section.&para;<br>&para;<br>```python&para;<br># From Opus 4.1&para;<br>model="claude-opus-4-1-20250805"   </span><del style="background:#ffe6e6;"> </del><span># Before&para;<br>model="claude-opus-4-6"</span><del style="background:#ffe6e6;">   </del><span>            # After&para;<br>&para;<br># From Sonnet 4&para;<br>model="claude-sonnet-4-20250514"   </span><del style="background:#ffe6e6;"> </del><span># Before&para;<br>model="claude-opus-4-6"</span><del style="background:#ffe6e6;">  </del><span>            # After&para;<br>&para;<br># From Sonnet 3.7&para;<br>model="claude-3-7-sonnet-20250219"</span><ins style="background:#e6ffe6;"> </ins><span>  # Before&para;<br>model="claude-opus-4-6"              # After&para;<br>```&para;<br>&para;<br>#### Additional breaking changes&para;<br>&para;<br>1. **</span><del style="background:#ffe6e6;">S</del><ins style="background:#e6ffe6;">Update s</ins><span>ampling parameters**&para;<br>&para;<br>   &lt;Warning&gt;&para;<br>   This is a breaking change </span><ins style="background:#e6ffe6;">when migrating </ins><span>from Claude 3.x models.&para;<br>   &lt;/Warning&gt;&para;<br>&para;<br>   Use only `temperature` OR `top_p`, not both:&para;<br>&para;<br>   ```python&para;<br>   # Before - This will error in Claude 4+ models&para;<br>   response = client.messages.create(&para;<br>       model="claude-3-7-sonnet-20250219",&para;<br>       temperature=0.7,&para;<br>       top_p=0.9,  # Cannot use both&para;<br>       ...&para;<br>   )&para;<br>&para;<br>   # After&para;<br>   response = client.messages.create(&para;<br>       model="claude-opus-4-6",&para;<br>       temperature=0.7,  # Use temperature OR top_p, not both&para;<br>       ...&para;<br>   )&para;<br>   ```&para;<br>&para;<br>2. **</span><del style="background:#ffe6e6;">T</del><ins style="background:#e6ffe6;">Update t</ins><span>ool versions**&para;<br>&para;<br>   &lt;Warning&gt;&para;<br>   This is a breaking change </span><ins style="background:#e6ffe6;">when migrating </ins><span>from Claude 3.x models.&para;<br>   &lt;/Warning&gt;&para;<br>&para;<br>   Update to the latest tool versions. Remove any code using the `undo_edit` command.&para;<br>&para;<br>   ```python&para;<br>   # Before&para;<br>   tools=[{"type": "text_editor_20250124", "name": "str_replace_editor"}]&para;<br>&para;<br>   # After&para;<br>   tools=[{"type": "text_editor_20250728", "name": "str_replace_based_edit_tool"}]&para;<br>   ```&para;<br>&para;<br>   - **Text editor</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Use `text_editor_20250728` and `str_replace_based_edit_tool`. See [Text editor tool documentation](/docs/en/agents-and-tools/tool-use/text-editor-tool) for details.&para;<br>   - **Code execution</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Upgrade to `code_execution_20250825`. See [Code execution tool documentation](/docs/en/agents-and-tools/tool-use/code-execution-tool#upgrade-to-latest-tool-version) for migration instructions.&para;<br>&para;<br>3. **Handle the `refusal` stop reason**&para;<br>&para;<br>   Update your application to [handle `refusal` stop reasons](/docs/en/test-and-evaluate/strengthen-guardrails/handle-streaming-refusals):&para;<br>&para;<br>   ```python&para;<br>   response = client.messages.create(...)&para;<br>&para;<br>   if response.stop_reason == "refusal":&para;<br>       # Handle refusal appropriately&para;<br>       pass&para;<br>   ```&para;<br>&para;<br>4. **Handle the `model_context_window_exceeded` stop reason**&para;<br>&para;<br>   Claude 4.5+ models return a `model_context_window_exceeded` stop reason when generation stops due to hitting the context window limit, rather than the requested `max_tokens` limit. Update your application to handle this new stop reason:&para;<br>&para;<br>   ```python&para;<br>   response = client.messages.create(...)&para;<br>&para;<br>   if response.stop_reason == "model_context_window_exceeded":&para;<br>       # Handle context window limit appropriately&para;<br>       pass&para;<br>   ```&para;<br>&para;<br>5. **</span><del style="background:#ffe6e6;">T</del><ins style="background:#e6ffe6;">Verify t</ins><span>ool parameter handling (trailing newlines)**&para;<br>&para;<br>   Claude 4.5+ models preserve trailing newlines in tool call string parameters that were previously stripped. If your tools rely on exact string matching against tool call parameters, verify your logic handles trailing newlines correctly.&para;<br>&para;<br>6. **Update your prompts for behavioral changes**&para;<br>&para;<br>   Claude 4+ models have a more concise, direct communication style and require explicit direction. Review [prompting best practices](/docs/en/build-with-claude/prompt-engineering/claude-prompting-best-practices) for optimization guidance.&para;<br>&para;<br>#### Additional recommended changes&para;<br>&para;<br>- **Remove legacy beta headers</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Remove `token-efficient-tools-2025-02-19` and `output-128k-2025-02-19`</span><del style="background:#ffe6e6;"> — a</del><ins style="background:#e6ffe6;">. A</ins><span>ll Claude 4+ models have built-in token-efficient tool use and these headers have no effect.&para;<br>&para;<br>### Claude 4.6 migration checklist&para;<br>&para;<br>- [ ] Update model ID to `claude-opus-4-6`&para;<br>- [ ] **BREAKING</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Remove assistant message prefills (returns 400 error); use structured outputs or `output_config.format` instead&para;<br>- [ ] **Recommended</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Migrate from `thinking: {type: "enabled", budget_tokens: N}` to `thinking: {type: "adaptive"}` with the [effort parameter](/docs/en/build-with-claude/effort) (`budget_tokens` is deprecated and will be removed in a future release)&para;<br>- [ ] Verify tool call JSON parsing uses a standard JSON parser&para;<br>- [ ] Remove `effort-2025-11-24` beta header (effort is now GA)&para;<br>- [ ] Remove `fine-grained-tool-streaming-2025-05-14` beta header&para;<br>- [ ] Remove `interleaved-thinking-2025-05-14` beta header&para;<br>- [ ] Migrate `output_format` to `output_config.format` (if applicable)&para;<br>- [ ] If migrating from Claude 4.1 or earlier: update sampling parameters to use only `temperature` OR `top_p`&para;<br>- [ ] If migrating from Claude 4.1 or earlier: update tool versions (`text_editor_20250728`, `code_execution_20250825`)&para;<br>- [ ] If migrating from Claude 4.1 or earlier: handle `refusal` stop reason&para;<br>- [ ] If migrating from Claude 4.1 or earlier: handle `model_context_window_exceeded` stop reason&para;<br>- [ ] If migrating from Claude 4.1 or earlier: verify tool string parameter handling for trailing newlines&para;<br>- [ ] If migrating from Claude 4.1 or earlier: remove legacy beta headers (`token-efficient-tools-2025-02-19`, `output-128k-2025-02-19`)&para;<br>- [ ] Review and update prompts following [prompting best practices](/docs/en/build-with-claude/prompt-engineering/claude-prompting-best-practices)&para;<br>- [ ] Test in development environment before production deployment&para;<br>&para;<br>---&para;<br>&para;<br>## Migrating to Claude Sonnet 4.5&para;<br>&para;<br>Claude Sonnet 4.5 combines strong intelligence with fast performance, making it ideal for everyday coding, analysis, and content tasks.&para;<br>&para;<br>For a complete overview of capabilities, see the [models overview](/docs/en/about-claude/models/overview).&para;<br>&para;<br>&lt;Note&gt;&para;<br>Sonnet 4.5 pricing is $3 per million input tokens, $15 per million output tokens. See [Claude pricing](/docs/en/about-claude/pricing) for details.&para;<br>&lt;/Note&gt;&para;<br>&para;<br>**Update your model name:**&para;<br>&para;<br>```python&para;<br># From Sonnet 4&para;<br>model="claude-sonnet-4-20250514"     </span><del style="background:#ffe6e6;">   </del><span># Before&para;<br>model="claude-sonnet-4-5-20250929"</span><del style="background:#ffe6e6;">   </del><span>   # After&para;<br>&para;<br># From Sonnet 3.7&para;<br>model="claude-3-7-sonnet-20250219"   </span><del style="background:#ffe6e6;"> </del><del style="background:#ffe6e6;">  </del><span># Before&para;<br>model="claude-sonnet-4-5-20250929"</span><del style="background:#ffe6e6;">   </del><span>   # After&para;<br>```&para;<br>&para;<br></span><del style="background:#ffe6e6;">**Consider enabling extended thinking** for significant performance improvements on coding and reasoning tasks (disabled by default):&para;<br>&para;<br>```python&para;<br>response = client.messages.create(&para;<br>    model="claude-sonnet-4-5-20250929",&para;<br>    max_tokens=16000,&para;<br>    thinking={"type": "enabled", "budget_tokens": 10000},&para;<br>    messages=[...]&para;<br>)&para;<br>```&para;<br>&para;<br></del><span>### Breaking changes&para;<br>&para;<br>These breaking changes apply when migrating from Claude 3.x Sonnet models.&para;<br>&para;<br>1. **</span><del style="background:#ffe6e6;">S</del><ins style="background:#e6ffe6;">Update s</ins><span>ampling parameters**&para;<br>&para;<br>   &lt;Warning&gt;&para;<br>   This is a breaking change </span><ins style="background:#e6ffe6;">when migrating </ins><span>from Claude 3.x models.&para;<br>   &lt;/Warning&gt;&para;<br>&para;<br>   Use only `temperature` OR `top_p`, not both.&para;<br>&para;<br>2. **</span><del style="background:#ffe6e6;">T</del><ins style="background:#e6ffe6;">Update t</ins><span>ool versions**&para;<br>&para;<br>   &lt;Warning&gt;&para;<br>   This is a breaking change </span><ins style="background:#e6ffe6;">when migrating </ins><span>from Claude 3.x models.&para;<br>   &lt;/Warning&gt;&para;<br>&para;<br>   Update to the latest tool versions (`text_editor_20250728`, `code_execution_20250825`). Remove any code using the `undo_edit` command.&para;<br>&para;<br>3. **Handle the `refusal` stop reason**&para;<br>&para;<br>   Update your application to [handle `refusal` stop reasons](/docs/en/test-and-evaluate/strengthen-guardrails/handle-streaming-refusals).&para;<br>&para;<br>4. **Update your prompts for behavioral changes**&para;<br>&para;<br>   Claude 4 models have a more concise, direct communication style. Review [prompting best practices](/docs/en/build-with-claude/prompt-engineering/claude-prompting-best-practices) for optimization guidance.&para;<br>&para;<br>### Sonnet 4.5 migration checklist&para;<br>&para;<br>- [ ] Update model ID to `claude-sonnet-4-5-20250929`&para;<br>- [ ] **BREAKING</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Update tool versions to latest (`text_editor_20250728`, `code_execution_20250825`)</span><del style="background:#ffe6e6;"> —</del><ins style="background:#e6ffe6;">;</ins><span> legacy versions </span><ins style="background:#e6ffe6;">are </ins><span>not supported (if migrating from 3.x)&para;<br>- [ ] **BREAKING</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Remove any code using the `undo_edit` command (if applicable)&para;<br>- [ ] **BREAKING</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Update sampling parameters to use only `temperature` OR `top_p`, not both (if migrating from 3.x)&para;<br>- [ ] Handle new `refusal` stop reason in your application&para;<br>- [ ] Review and update prompts following [prompting best practices](/docs/en/build-with-claude/prompt-engineering/claude-prompting-best-practices)&para;<br>- [ ] Consider enabling extended thinking for complex reasoning tasks&para;<br>- [ ] Test in development environment before production deployment&para;<br>&para;<br>---&para;<br>&para;<br>## Migrating to Claude Haiku 4.5&para;<br>&para;<br>Claude Haiku 4.5 is </span><del style="background:#ffe6e6;">our</del><ins style="background:#e6ffe6;">the</ins><span> fastest and most intelligent Haiku model with near-frontier performance, delivering premium model quality for interactive applications and high-volume processing.&para;<br>&para;<br>For a complete overview of capabilities, see the [models overview](/docs/en/about-claude/models/overview).&para;<br>&para;<br>&lt;Note&gt;&para;<br>Haiku 4.5 pricing is $1 per million input tokens, $5 per million output tokens. See [Claude pricing](/docs/en/about-claude/pricing) for details.&para;<br>&lt;/Note&gt;&para;<br>&para;<br>**Update your model name:**&para;<br>&para;<br>```python&para;<br># From Haiku 3.5&para;<br>model="claude-3-5-haiku-20241022"</span><del style="background:#ffe6e6;">   </del><span>   # Before&para;<br>model="claude-haiku-4-5-20251001"</span><del style="background:#ffe6e6;">   </del><span>   # After&para;<br>```&para;<br>&para;<br>**Review new rate limits:** Haiku 4.5 has separate rate limits from Haiku 3.5. See [Rate limits documentation](/docs/en/api/rate-limits) for details.&para;<br>&para;<br></span><del style="background:#ffe6e6;">**Consider enabling extended thinking** f</del><ins style="background:#e6ffe6;">&lt;Tip&gt;&para;<br>F</ins><span>or significant performance improvements on coding and reasoning tasks</span><del style="background:#ffe6e6;"> (disabled by default):&para;<br>&para;<br>```python&para;<br>response = client.messages.create(&para;<br>    model="claude-haiku-4-5-20251001",&para;<br>    max_tokens=16000,&para;<br>    </del><ins style="background:#e6ffe6;">, consider enabling extended thinking with `</ins><span>thinking</span><del style="background:#ffe6e6;">={"</del><ins style="background:#e6ffe6;">: {</ins><span>type</span><del style="background:#ffe6e6;">"</del><span>: "enabled", </span><del style="background:#ffe6e6;">"</del><span>budget_tokens</span><del style="background:#ffe6e6;">"</del><span>: </span><del style="background:#ffe6e6;">5000},&para;<br>    messages=[...]&para;<br>)&para;<br>```</del><ins style="background:#e6ffe6;">N}`.&para;<br>&lt;/Tip&gt;</ins><span>&para;<br>&para;<br>&lt;Note&gt;&para;<br>Extended thinking impacts [prompt caching](/docs/en/build-with-claude/prompt-caching#caching-with-thinking-blocks) efficiency.</span><ins style="background:#e6ffe6;">&para;<br>&para;<br>Extended thinking is deprecated in Claude 4.6 or newer models. If using newer models, use [adaptive thinking](/docs/en/build-with-claude/adaptive-thinking) instead.</ins><span>&para;<br>&lt;/Note&gt;&para;<br>&para;<br>**Explore new capabilities:** See the [models overview](/docs/en/about-claude/models/overview) for details on context awareness, increased output capacity (64K tokens), higher intelligence, and improved speed.&para;<br>&para;<br>### Breaking changes&para;<br>&para;<br>These breaking changes apply when migrating from Claude 3.x Haiku models.&para;<br>&para;<br>1. **</span><del style="background:#ffe6e6;">S</del><ins style="background:#e6ffe6;">Update s</ins><span>ampling parameters**&para;<br>&para;<br>   &lt;Warning&gt;&para;<br>   This is a breaking change </span><ins style="background:#e6ffe6;">when migrating </ins><span>from Claude 3.x models.&para;<br>   &lt;/Warning&gt;&para;<br>&para;<br>   Use only `temperature` OR `top_p`, not both.&para;<br>&para;<br>2. **</span><del style="background:#ffe6e6;">T</del><ins style="background:#e6ffe6;">Update t</ins><span>ool versions**&para;<br>&para;<br>   &lt;Warning&gt;&para;<br>   This is a breaking change </span><ins style="background:#e6ffe6;">when migrating </ins><span>from Claude 3.x models.&para;<br>   &lt;/Warning&gt;&para;<br>&para;<br>   Update to the latest tool versions (`text_editor_20250728`, `code_execution_20250825`). Remove any code using the `undo_edit` command.&para;<br>&para;<br>3. **Handle the `refusal` stop reason**&para;<br>&para;<br>   Update your application to [handle `refusal` stop reasons](/docs/en/test-and-evaluate/strengthen-guardrails/handle-streaming-refusals).&para;<br>&para;<br>4. **Update your prompts for behavioral changes**&para;<br>&para;<br>   Claude 4 models have a more concise, direct communication style. Review [prompting best practices](/docs/en/build-with-claude/prompt-engineering/claude-prompting-best-practices) for optimization guidance.&para;<br>&para;<br>### Haiku 4.5 migration checklist&para;<br>&para;<br>- [ ] Update model ID to `claude-haiku-4-5-20251001`&para;<br>- [ ] **BREAKING</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Update tool versions to latest (`text_editor_20250728`, `code_execution_20250825`)</span><del style="background:#ffe6e6;"> —</del><ins style="background:#e6ffe6;">;</ins><span> legacy versions </span><ins style="background:#e6ffe6;">are </ins><span>not supported&para;<br>- [ ] **BREAKING</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Remove any code using the `undo_edit` command (if applicable)&para;<br>- [ ] **BREAKING</span><ins style="background:#e6ffe6;">:</ins><span>**</span><del style="background:#ffe6e6;">:</del><span> Update sampling parameters to use only `temperature` OR `top_p`, not both&para;<br>- [ ] Handle new `refusal` stop reason in your application&para;<br>- [ ] Review and adjust for new rate limits (separate from Haiku 3.5)&para;<br>- [ ] Review and update prompts following [prompting best practices](/docs/en/build-with-claude/prompt-engineering/claude-prompting-best-practices)&para;<br>- [ ] Consider enabling extended thinking for complex reasoning tasks&para;<br>- [ ] Test in development environment before production deployment&para;<br>&para;<br>---&para;<br>&para;<br>## Need help?&para;<br>&para;<br>- Check </span><del style="background:#ffe6e6;">our</del><ins style="background:#e6ffe6;">the</ins><span> [API documentation](/docs/en/api/overview) for detailed specifications&para;<br>- Review [model capabilities](/docs/en/about-claude/models/overview) for performance comparisons&para;<br>- Review [API release notes](/docs/en/release-notes/api) for API updates&para;<br>- Contact support if you encounter any issues during migration</span></div>
        </div>

        <h2 style="margin-top: 2rem; margin-bottom: 1rem;">Unified Diff</h2>
        <pre><code>--- a/about-claude/models/migrating-to-claude-4.md
+++ b/about-claude/models/migrating-to-claude-4.md
@@ -12,21 +12,21 @@
 
 ```python
 # Opus migration
-model=&#34;claude-opus-4-5&#34;     # Before
-model=&#34;claude-opus-4-6&#34;       # After
+model=&#34;claude-opus-4-5&#34;   # Before
+model=&#34;claude-opus-4-6&#34;   # After
 ```
 
 ### Breaking changes
 
-1. **Prefill removal**: Prefilling assistant messages returns a 400 error on Claude 4.6 models. Use [structured outputs](/docs/en/build-with-claude/structured-outputs), system prompt instructions, or `output_config.format` instead.
-
-2. **Tool parameter quoting**: Claude 4.6 models may produce slightly different JSON string escaping in tool call arguments (e.g., different handling of Unicode escapes or forward slash escaping). If you parse tool call `input` as a raw string rather than using a JSON parser, verify your parsing logic. Standard JSON parsers (like `json.loads()` or `JSON.parse()`) handle these differences automatically.
+1. **Prefill removal:** Prefilling assistant messages returns a 400 error on Claude 4.6 models. Use [structured outputs](/docs/en/build-with-claude/structured-outputs), system prompt instructions, or `output_config.format` instead.
+
+2. **Tool parameter quoting:** Claude 4.6 models may produce slightly different JSON string escaping in tool call arguments (e.g., different handling of Unicode escapes or forward slash escaping). If you parse tool call `input` as a raw string rather than using a JSON parser, verify your parsing logic. Standard JSON parsers (like `json.loads()` or `JSON.parse()`) handle these differences automatically.
 
 ### Recommended changes
 
 These are not required but will improve your experience:
 
-1. **Migrate to adaptive thinking**: `thinking: {type: &#34;enabled&#34;, budget_tokens: N}` is deprecated on Claude 4.6 models and will be removed in a future model release. Switch to `thinking: {type: &#34;adaptive&#34;}` and use the [effort parameter](/docs/en/build-with-claude/effort) to control thinking depth. See [Adaptive thinking](/docs/en/build-with-claude/adaptive-thinking).
+1. **Migrate to adaptive thinking:** `thinking: {type: &#34;enabled&#34;, budget_tokens: N}` is deprecated on Claude 4.6 models and will be removed in a future model release. Switch to `thinking: {type: &#34;adaptive&#34;}` and use the [effort parameter](/docs/en/build-with-claude/effort) to control thinking depth. See [Adaptive thinking](/docs/en/build-with-claude/adaptive-thinking).
 
    &lt;CodeGroup&gt;
    ```python Before
@@ -57,15 +57,15 @@
    ```
    &lt;/CodeGroup&gt;
 
-   Note that the migration also moves from `client.beta.messages.create` to `client.messages.create` — adaptive thinking and effort are GA features and do not require the beta SDK namespace or any beta headers.
-
-2. **Remove effort beta header**: The effort parameter is now GA. Remove `betas=[&#34;effort-2025-11-24&#34;]` from your requests.
-
-3. **Remove fine-grained tool streaming beta header**: Fine-grained tool streaming is now GA. Remove `betas=[&#34;fine-grained-tool-streaming-2025-05-14&#34;]` from your requests.
-
-4. **Remove interleaved thinking beta header**: Adaptive thinking automatically enables interleaved thinking. Remove `betas=[&#34;interleaved-thinking-2025-05-14&#34;]` from your requests.
-
-5. **Migrate to output_config.format**: If using structured outputs, update `output_format={...}` to `output_config={&#34;format&#34;: {...}}`. The old parameter remains functional but is deprecated and will be removed in a future model release.
+   Note that the migration also moves from `client.beta.messages.create` to `client.messages.create`. Adaptive thinking and effort are GA features and do not require the beta SDK namespace or any beta headers.
+
+2. **Remove effort beta header:** The effort parameter is now GA. Remove `betas=[&#34;effort-2025-11-24&#34;]` from your requests.
+
+3. **Remove fine-grained tool streaming beta header:** Fine-grained tool streaming is now GA. Remove `betas=[&#34;fine-grained-tool-streaming-2025-05-14&#34;]` from your requests.
+
+4. **Remove interleaved thinking beta header:** Adaptive thinking automatically enables interleaved thinking. Remove `betas=[&#34;interleaved-thinking-2025-05-14&#34;]` from your requests.
+
+5. **Migrate to output_config.format:** If using structured outputs, update `output_format={...}` to `output_config={&#34;format&#34;: {...}}`. The old parameter remains functional but is deprecated and will be removed in a future model release.
 
 ### Migrating from Claude 4.1 or earlier to Claude 4.6
 
@@ -73,24 +73,24 @@
 
 ```python
 # From Opus 4.1
-model=&#34;claude-opus-4-1-20250805&#34;    # Before
-model=&#34;claude-opus-4-6&#34;               # After
+model=&#34;claude-opus-4-1-20250805&#34;   # Before
+model=&#34;claude-opus-4-6&#34;            # After
 
 # From Sonnet 4
-model=&#34;claude-sonnet-4-20250514&#34;    # Before
-model=&#34;claude-opus-4-6&#34;              # After
+model=&#34;claude-sonnet-4-20250514&#34;   # Before
+model=&#34;claude-opus-4-6&#34;            # After
 
 # From Sonnet 3.7
-model=&#34;claude-3-7-sonnet-20250219&#34;  # Before
+model=&#34;claude-3-7-sonnet-20250219&#34;   # Before
 model=&#34;claude-opus-4-6&#34;              # After
 ```
 
 #### Additional breaking changes
 
-1. **Sampling parameters**
-
-   &lt;Warning&gt;
-   This is a breaking change from Claude 3.x models.
+1. **Update sampling parameters**
+
+   &lt;Warning&gt;
+   This is a breaking change when migrating from Claude 3.x models.
    &lt;/Warning&gt;
 
    Use only `temperature` OR `top_p`, not both:
@@ -112,10 +112,10 @@
    )
    ```
 
-2. **Tool versions**
-
-   &lt;Warning&gt;
-   This is a breaking change from Claude 3.x models.
+2. **Update tool versions**
+
+   &lt;Warning&gt;
+   This is a breaking change when migrating from Claude 3.x models.
    &lt;/Warning&gt;
 
    Update to the latest tool versions. Remove any code using the `undo_edit` command.
@@ -128,8 +128,8 @@
    tools=[{&#34;type&#34;: &#34;text_editor_20250728&#34;, &#34;name&#34;: &#34;str_replace_based_edit_tool&#34;}]
    ```
 
-   - **Text editor**: Use `text_editor_20250728` and `str_replace_based_edit_tool`. See [Text editor tool documentation](/docs/en/agents-and-tools/tool-use/text-editor-tool) for details.
-   - **Code execution**: Upgrade to `code_execution_20250825`. See [Code execution tool documentation](/docs/en/agents-and-tools/tool-use/code-execution-tool#upgrade-to-latest-tool-version) for migration instructions.
+   - **Text editor:** Use `text_editor_20250728` and `str_replace_based_edit_tool`. See [Text editor tool documentation](/docs/en/agents-and-tools/tool-use/text-editor-tool) for details.
+   - **Code execution:** Upgrade to `code_execution_20250825`. See [Code execution tool documentation](/docs/en/agents-and-tools/tool-use/code-execution-tool#upgrade-to-latest-tool-version) for migration instructions.
 
 3. **Handle the `refusal` stop reason**
 
@@ -155,7 +155,7 @@
        pass
    ```
 
-5. **Tool parameter handling (trailing newlines)**
+5. **Verify tool parameter handling (trailing newlines)**
 
    Claude 4.5+ models preserve trailing newlines in tool call string parameters that were previously stripped. If your tools rely on exact string matching against tool call parameters, verify your logic handles trailing newlines correctly.
 
@@ -165,13 +165,13 @@
 
 #### Additional recommended changes
 
-- **Remove legacy beta headers**: Remove `token-efficient-tools-2025-02-19` and `output-128k-2025-02-19` — all Claude 4+ models have built-in token-efficient tool use and these headers have no effect.
+- **Remove legacy beta headers:** Remove `token-efficient-tools-2025-02-19` and `output-128k-2025-02-19`. All Claude 4+ models have built-in token-efficient tool use and these headers have no effect.
 
 ### Claude 4.6 migration checklist
 
 - [ ] Update model ID to `claude-opus-4-6`
-- [ ] **BREAKING**: Remove assistant message prefills (returns 400 error); use structured outputs or `output_config.format` instead
-- [ ] **Recommended**: Migrate from `thinking: {type: &#34;enabled&#34;, budget_tokens: N}` to `thinking: {type: &#34;adaptive&#34;}` with the [effort parameter](/docs/en/build-with-claude/effort) (`budget_tokens` is deprecated and will be removed in a future release)
+- [ ] **BREAKING:** Remove assistant message prefills (returns 400 error); use structured outputs or `output_config.format` instead
+- [ ] **Recommended:** Migrate from `thinking: {type: &#34;enabled&#34;, budget_tokens: N}` to `thinking: {type: &#34;adaptive&#34;}` with the [effort parameter](/docs/en/build-with-claude/effort) (`budget_tokens` is deprecated and will be removed in a future release)
 - [ ] Verify tool call JSON parsing uses a standard JSON parser
 - [ ] Remove `effort-2025-11-24` beta header (effort is now GA)
 - [ ] Remove `fine-grained-tool-streaming-2025-05-14` beta header
@@ -202,41 +202,30 @@
 
 ```python
 # From Sonnet 4
-model=&#34;claude-sonnet-4-20250514&#34;        # Before
-model=&#34;claude-sonnet-4-5-20250929&#34;      # After
+model=&#34;claude-sonnet-4-20250514&#34;     # Before
+model=&#34;claude-sonnet-4-5-20250929&#34;   # After
 
 # From Sonnet 3.7
-model=&#34;claude-3-7-sonnet-20250219&#34;      # Before
-model=&#34;claude-sonnet-4-5-20250929&#34;      # After
+model=&#34;claude-3-7-sonnet-20250219&#34;   # Before
+model=&#34;claude-sonnet-4-5-20250929&#34;   # After
 ```
 
-**Consider enabling extended thinking** for significant performance improvements on coding and reasoning tasks (disabled by default):
-
-```python
-response = client.messages.create(
-    model=&#34;claude-sonnet-4-5-20250929&#34;,
-    max_tokens=16000,
-    thinking={&#34;type&#34;: &#34;enabled&#34;, &#34;budget_tokens&#34;: 10000},
-    messages=[...]
-)
-```
-
 ### Breaking changes
 
 These breaking changes apply when migrating from Claude 3.x Sonnet models.
 
-1. **Sampling parameters**
-
-   &lt;Warning&gt;
-   This is a breaking change from Claude 3.x models.
+1. **Update sampling parameters**
+
+   &lt;Warning&gt;
+   This is a breaking change when migrating from Claude 3.x models.
    &lt;/Warning&gt;
 
    Use only `temperature` OR `top_p`, not both.
 
-2. **Tool versions**
-
-   &lt;Warning&gt;
-   This is a breaking change from Claude 3.x models.
+2. **Update tool versions**
+
+   &lt;Warning&gt;
+   This is a breaking change when migrating from Claude 3.x models.
    &lt;/Warning&gt;
 
    Update to the latest tool versions (`text_editor_20250728`, `code_execution_20250825`). Remove any code using the `undo_edit` command.
@@ -252,9 +241,9 @@
 ### Sonnet 4.5 migration checklist
 
 - [ ] Update model ID to `claude-sonnet-4-5-20250929`
-- [ ] **BREAKING**: Update tool versions to latest (`text_editor_20250728`, `code_execution_20250825`) — legacy versions not supported (if migrating from 3.x)
-- [ ] **BREAKING**: Remove any code using the `undo_edit` command (if applicable)
-- [ ] **BREAKING**: Update sampling parameters to use only `temperature` OR `top_p`, not both (if migrating from 3.x)
+- [ ] **BREAKING:** Update tool versions to latest (`text_editor_20250728`, `code_execution_20250825`); legacy versions are not supported (if migrating from 3.x)
+- [ ] **BREAKING:** Remove any code using the `undo_edit` command (if applicable)
+- [ ] **BREAKING:** Update sampling parameters to use only `temperature` OR `top_p`, not both (if migrating from 3.x)
 - [ ] Handle new `refusal` stop reason in your application
 - [ ] Review and update prompts following [prompting best practices](/docs/en/build-with-claude/prompt-engineering/claude-prompting-best-practices)
 - [ ] Consider enabling extended thinking for complex reasoning tasks
@@ -264,7 +253,7 @@
 
 ## Migrating to Claude Haiku 4.5
 
-Claude Haiku 4.5 is our fastest and most intelligent Haiku model with near-frontier performance, delivering premium model quality for interactive applications and high-volume processing.
+Claude Haiku 4.5 is the fastest and most intelligent Haiku model with near-frontier performance, delivering premium model quality for interactive applications and high-volume processing.
 
 For a complete overview of capabilities, see the [models overview](/docs/en/about-claude/models/overview).
 
@@ -276,25 +265,20 @@
 
 ```python
 # From Haiku 3.5
-model=&#34;claude-3-5-haiku-20241022&#34;      # Before
-model=&#34;claude-haiku-4-5-20251001&#34;      # After
+model=&#34;claude-3-5-haiku-20241022&#34;   # Before
+model=&#34;claude-haiku-4-5-20251001&#34;   # After
 ```
 
 **Review new rate limits:** Haiku 4.5 has separate rate limits from Haiku 3.5. See [Rate limits documentation](/docs/en/api/rate-limits) for details.
 
-**Consider enabling extended thinking** for significant performance improvements on coding and reasoning tasks (disabled by default):
-
-```python
-response = client.messages.create(
-    model=&#34;claude-haiku-4-5-20251001&#34;,
-    max_tokens=16000,
-    thinking={&#34;type&#34;: &#34;enabled&#34;, &#34;budget_tokens&#34;: 5000},
-    messages=[...]
-)
-```
+&lt;Tip&gt;
+For significant performance improvements on coding and reasoning tasks, consider enabling extended thinking with `thinking: {type: &#34;enabled&#34;, budget_tokens: N}`.
+&lt;/Tip&gt;
 
 &lt;Note&gt;
 Extended thinking impacts [prompt caching](/docs/en/build-with-claude/prompt-caching#caching-with-thinking-blocks) efficiency.
+
+Extended thinking is deprecated in Claude 4.6 or newer models. If using newer models, use [adaptive thinking](/docs/en/build-with-claude/adaptive-thinking) instead.
 &lt;/Note&gt;
 
 **Explore new capabilities:** See the [models overview](/docs/en/about-claude/models/overview) for details on context awareness, increased output capacity (64K tokens), higher intelligence, and improved speed.
@@ -303,18 +287,18 @@
 
 These breaking changes apply when migrating from Claude 3.x Haiku models.
 
-1. **Sampling parameters**
-
-   &lt;Warning&gt;
-   This is a breaking change from Claude 3.x models.
+1. **Update sampling parameters**
+
+   &lt;Warning&gt;
+   This is a breaking change when migrating from Claude 3.x models.
    &lt;/Warning&gt;
 
    Use only `temperature` OR `top_p`, not both.
 
-2. **Tool versions**
-
-   &lt;Warning&gt;
-   This is a breaking change from Claude 3.x models.
+2. **Update tool versions**
+
+   &lt;Warning&gt;
+   This is a breaking change when migrating from Claude 3.x models.
    &lt;/Warning&gt;
 
    Update to the latest tool versions (`text_editor_20250728`, `code_execution_20250825`). Remove any code using the `undo_edit` command.
@@ -330,9 +314,9 @@
 ### Haiku 4.5 migration checklist
 
 - [ ] Update model ID to `claude-haiku-4-5-20251001`
-- [ ] **BREAKING**: Update tool versions to latest (`text_editor_20250728`, `code_execution_20250825`) — legacy versions not supported
-- [ ] **BREAKING**: Remove any code using the `undo_edit` command (if applicable)
-- [ ] **BREAKING**: Update sampling parameters to use only `temperature` OR `top_p`, not both
+- [ ] **BREAKING:** Update tool versions to latest (`text_editor_20250728`, `code_execution_20250825`); legacy versions are not supported
+- [ ] **BREAKING:** Remove any code using the `undo_edit` command (if applicable)
+- [ ] **BREAKING:** Update sampling parameters to use only `temperature` OR `top_p`, not both
 - [ ] Handle new `refusal` stop reason in your application
 - [ ] Review and adjust for new rate limits (separate from Haiku 3.5)
 - [ ] Review and update prompts following [prompting best practices](/docs/en/build-with-claude/prompt-engineering/claude-prompting-best-practices)
@@ -343,7 +327,7 @@
 
 ## Need help?
 
-- Check our [API documentation](/docs/en/api/overview) for detailed specifications
+- Check the [API documentation](/docs/en/api/overview) for detailed specifications
 - Review [model capabilities](/docs/en/about-claude/models/overview) for performance comparisons
 - Review [API release notes](/docs/en/release-notes/api) for API updates
 - Contact support if you encounter any issues during migration</code></pre>
    </div>
</body>
</html>