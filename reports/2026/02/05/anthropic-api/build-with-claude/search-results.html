<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>build-with-claude/search-results - Diff Report</title>
    <link rel="stylesheet" href="../../css/diff.css">
    <style>
        :root {
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --text-color: #eee;
            --accent: #0f3460;
            --add-bg: #1a4d1a;
            --del-bg: #4d1a1a;
            --add-text: #4ade80;
            --del-text: #f87171;
        }
        @media (prefers-color-scheme: light) {
            :root {
                --bg-color: #f5f5f5;
                --card-bg: #fff;
                --text-color: #333;
                --accent: #e0e0e0;
                --add-bg: #d4edda;
                --del-bg: #f8d7da;
                --add-text: #155724;
                --del-text: #721c24;
            }
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 2rem;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { margin-bottom: 2rem; }
        h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .meta { color: #888; font-size: 0.9rem; }
        .summary {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            display: flex;
            gap: 2rem;
        }
        .stat { display: flex; align-items: center; gap: 0.5rem; }
        .stat.added { color: var(--add-text); }
        .stat.removed { color: var(--del-text); }
        .analysis {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border-left: 4px solid #8b5cf6;
        }
        .analysis-header {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #8b5cf6;
        }
        .analysis-content {
            white-space: pre-wrap;
            font-size: 0.95rem;
            line-height: 1.7;
        }
        .diff-container {
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
        }
        .diff-header {
            background: var(--accent);
            padding: 0.75rem 1rem;
            font-weight: 600;
        }
        .diff-content {
            padding: 1rem;
            overflow-x: auto;
        }
        .diff-content ins {
            background: var(--add-bg);
            color: var(--add-text);
            text-decoration: none;
            padding: 0.1em 0.2em;
            border-radius: 2px;
        }
        .diff-content del {
            background: var(--del-bg);
            color: var(--del-text);
            text-decoration: line-through;
            padding: 0.1em 0.2em;
            border-radius: 2px;
        }
        pre {
            background: var(--accent);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
            margin-top: 2rem;
        }
        a { color: #60a5fa; }
        .back-link { margin-bottom: 1rem; display: inline-block; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../index.html" class="back-link">&larr; Back to daily report</a>

        <header>
            <h1>build-with-claude/search-results.md</h1>
            <p class="meta">Changed on 2026-02-05 12:43:36 EST</p>
        </header>

        <div class="summary">
            <div class="stat added">
                <span>+8</span> lines added
            </div>
            <div class="stat removed">
                <span>-7</span> lines removed
            </div>
        </div>

        

        <div class="diff-container">
            <div class="diff-header">Visual Diff</div>
            <div class="diff-content"><span># Search results&para;<br>&para;<br>Enable natural citations for RAG applications by providing search results with source attribution&para;<br>&para;<br>---&para;<br>&para;<br>Search result content blocks enable natural citations with proper source attribution, bringing web search-quality citations to your custom applications. This feature is particularly powerful for RAG (Retrieval-Augmented Generation) applications where you need Claude to cite sources accurately.&para;<br>&para;<br>The search results feature is available on the following models:&para;<br>&para;<br></span><ins style="background:#e6ffe6;">- Claude Opus 4.6 (`claude-opus-4-6`)&para;<br>- Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`)&para;<br></ins><span>- Claude Opus 4.5 (`claude-opus-4-5-20251101`)&para;<br></span><span>- Claude Opus 4.1 (`claude-opus-4-1-20250805`)&para;<br>- Claude Opus 4 (`claude-opus-4-20250514`)&para;<br></span><del style="background:#ffe6e6;">- Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`)&para;<br></del><span>- Claude Sonnet 4 (`claude-sonnet-4-20250514`)&para;<br>- Claude Sonnet 3.7 ([deprecated](/docs/en/about-claude/model-deprecations)) (`claude-3-7-sonnet-20250219`)&para;<br>- Claude Haiku 4.5 (`claude-haiku-4-5-20251001`)&para;<br>- Claude Haiku 3.5 ([deprecated](/docs/en/about-claude/model-deprecations)) (`claude-3-5-haiku-20241022`)&para;<br>&para;<br>## Key benefits&para;<br>&para;<br>- **Natural citations** - Achieve the same citation quality as web search for any content&para;<br>- **Flexible integration** - Use in tool returns for dynamic RAG or as top-level content for pre-fetched data&para;<br>- **Proper source attribution** - Each result includes source and title information for clear attribution&para;<br>- **No document workarounds needed** - Eliminates the need for document-based workarounds&para;<br>- **Consistent citation format** - Matches the citation quality and format of Claude's web search functionality&para;<br>&para;<br>## How it works&para;<br>&para;<br>Search results can be provided in two ways:&para;<br>&para;<br>1. **From tool calls** - Your custom tools return search results, enabling dynamic RAG applications&para;<br>2. **As top-level content** - You provide search results directly in user messages for pre-fetched or cached content&para;<br>&para;<br>In both cases, Claude can automatically cite information from the search results with proper source attribution.&para;<br>&para;<br>### Search result schema&para;<br>&para;<br>Search results use the following structure:&para;<br>&para;<br>```json&para;<br>{&para;<br>  "type": "search_result",&para;<br>  "source": "https://example.com/article",  // Required: Source URL or identifier&para;<br>  "title": "Article Title",                  // Required: Title of the result&para;<br>  "content": [                               // Required: Array of text blocks&para;<br>    {&para;<br>      "type": "text",&para;<br>      "text": "The actual content of the search result..."&para;<br>    }&para;<br>  ],&para;<br>  "citations": {                             // Optional: Citation configuration&para;<br>    "enabled": true                          // Enable/disable citations for this result&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>### Required fields&para;<br>&para;<br>| Field | Type | Description |&para;<br>|-------|------|-------------|&para;<br>| `type` | string | Must be `"search_result"` |&para;<br>| `source` | string | The source URL or identifier for the content |&para;<br>| `title` | string | A descriptive title for the search result |&para;<br>| `content` | array | An array of text blocks containing the actual content |&para;<br>&para;<br>### Optional fields&para;<br>&para;<br>| Field | Type | Description |&para;<br>|-------|------|-------------|&para;<br>| `citations` | object | Citation configuration with `enabled` boolean field |&para;<br>| `cache_control` | object | Cache control settings (e.g., `{"type": "ephemeral"}`) |&para;<br>&para;<br>Each item in the `content` array must be a text block with:&para;<br>- `type`: Must be `"text"`&para;<br>- `text`: The actual text content (non-empty string)&para;<br>&para;<br>## Method 1: Search results from tool calls&para;<br>&para;<br>The most powerful use case is returning search results from your custom tools. This enables dynamic RAG applications where tools fetch and return relevant content with automatic citations.&para;<br>&para;<br>### Example: Knowledge base tool&para;<br>&para;<br>&lt;CodeGroup&gt;&para;<br>```python Python&para;<br>from anthropic import Anthropic&para;<br>from anthropic.types import (&para;<br>    MessageParam,&para;<br>    TextBlockParam,&para;<br>    SearchResultBlockParam,&para;<br>    ToolResultBlockParam&para;<br>)&para;<br>&para;<br>client = Anthropic()&para;<br>&para;<br># Define a knowledge base search tool&para;<br>knowledge_base_tool = {&para;<br>    "name": "search_knowledge_base",&para;<br>    "description": "Search the company knowledge base for information",&para;<br>    "input_schema": {&para;<br>        "type": "object",&para;<br>        "properties": {&para;<br>            "query": {&para;<br>                "type": "string",&para;<br>                "description": "The search query"&para;<br>            }&para;<br>        },&para;<br>        "required": ["query"]&para;<br>    }&para;<br>}&para;<br>&para;<br># Function to handle the tool call&para;<br>def search_knowledge_base(query):&para;<br>    # Your search logic here&para;<br>    # Returns search results in the correct format&para;<br>    return [&para;<br>        SearchResultBlockParam(&para;<br>            type="search_result",&para;<br>            source="https://docs.company.com/product-guide",&para;<br>            title="Product Configuration Guide",&para;<br>            content=[&para;<br>                TextBlockParam(&para;<br>                    type="text",&para;<br>                    text="To configure the product, navigate to Settings &gt; Configuration. The default timeout is 30 seconds, but can be adjusted between 10-120 seconds based on your needs."&para;<br>                )&para;<br>            ],&para;<br>            citations={"enabled": True}&para;<br>        ),&para;<br>        SearchResultBlockParam(&para;<br>            type="search_result",&para;<br>            source="https://docs.company.com/troubleshooting",&para;<br>            title="Troubleshooting Guide",&para;<br>            content=[&para;<br>                TextBlockParam(&para;<br>                    type="text",&para;<br>                    text="If you encounter timeout errors, first check the configuration settings. Common causes include network latency and incorrect timeout values."&para;<br>                )&para;<br>            ],&para;<br>            citations={"enabled": True}&para;<br>        )&para;<br>    ]&para;<br>&para;<br># Create a message with the tool&para;<br>response = client.messages.create(&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",  # Works with all supported models&para;<br>    max_tokens=1024,&para;<br>    tools=[knowledge_base_tool],&para;<br>    messages=[&para;<br>        MessageParam(&para;<br>            role="user",&para;<br>            content="How do I configure the timeout settings?"&para;<br>        )&para;<br>    ]&para;<br>)&para;<br>&para;<br># When Claude calls the tool, provide the search results&para;<br>if response.content[0].type == "tool_use":&para;<br>    tool_result = search_knowledge_base(response.content[0].input["query"])&para;<br>    &para;<br>    # Send the tool result back&para;<br>    final_response = client.messages.create(&para;<br>        model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",  # Works with all supported models&para;<br>        max_tokens=1024,&para;<br>        messages=[&para;<br>            MessageParam(role="user", content="How do I configure the timeout settings?"),&para;<br>            MessageParam(role="assistant", content=response.content),&para;<br>            MessageParam(&para;<br>                role="user",&para;<br>                content=[&para;<br>                    ToolResultBlockParam(&para;<br>                        type="tool_result",&para;<br>                        tool_use_id=response.content[0].id,&para;<br>                        content=tool_result  # Search results go here&para;<br>                    )&para;<br>                ]&para;<br>            )&para;<br>        ]&para;<br>    )&para;<br>```&para;<br>&para;<br>```typescript TypeScript&para;<br>import { Anthropic } from '@anthropic-ai/sdk';&para;<br>&para;<br>const anthropic = new Anthropic();&para;<br>&para;<br>// Define a knowledge base search tool&para;<br>const knowledgeBaseTool = {&para;<br>  name: "search_knowledge_base",&para;<br>  description: "Search the company knowledge base for information",&para;<br>  input_schema: {&para;<br>    type: "object",&para;<br>    properties: {&para;<br>      query: {&para;<br>        type: "string",&para;<br>        description: "The search query"&para;<br>      }&para;<br>    },&para;<br>    required: ["query"]&para;<br>  }&para;<br>};&para;<br>&para;<br>// Function to handle the tool call&para;<br>function searchKnowledgeBase(query: string) {&para;<br>  // Your search logic here&para;<br>  // Returns search results in the correct format&para;<br>  return [&para;<br>    {&para;<br>      type: "search_result" as const,&para;<br>      source: "https://docs.company.com/product-guide",&para;<br>      title: "Product Configuration Guide",&para;<br>      content: [&para;<br>        {&para;<br>          type: "text" as const,&para;<br>          text: "To configure the product, navigate to Settings &gt; Configuration. The default timeout is 30 seconds, but can be adjusted between 10-120 seconds based on your needs."&para;<br>        }&para;<br>      ],&para;<br>      citations: { enabled: true }&para;<br>    },&para;<br>    {&para;<br>      type: "search_result" as const,&para;<br>      source: "https://docs.company.com/troubleshooting",&para;<br>      title: "Troubleshooting Guide",&para;<br>      content: [&para;<br>        {&para;<br>          type: "text" as const,&para;<br>          text: "If you encounter timeout errors, first check the configuration settings. Common causes include network latency and incorrect timeout values."&para;<br>        }&para;<br>      ],&para;<br>      citations: { enabled: true }&para;<br>    }&para;<br>  ];&para;<br>}&para;<br>&para;<br>// Create a message with the tool&para;<br>const response = await anthropic.messages.create({&para;<br>  model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>", // Works with all supported models&para;<br>  max_tokens: 1024,&para;<br>  tools: [knowledgeBaseTool],&para;<br>  messages: [&para;<br>    {&para;<br>      role: "user",&para;<br>      content: "How do I configure the timeout settings?"&para;<br>    }&para;<br>  ]&para;<br>});&para;<br>&para;<br>// Handle tool use and provide results&para;<br>if (response.content[0].type === "tool_use") {&para;<br>  const toolResult = searchKnowledgeBase(response.content[0].input.query);&para;<br>  &para;<br>  const finalResponse = await anthropic.messages.create({&para;<br>    model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>", // Works with all supported models&para;<br>    max_tokens: 1024,&para;<br>      messages: [&para;<br>      { role: "user", content: "How do I configure the timeout settings?" },&para;<br>      { role: "assistant", content: response.content },&para;<br>      {&para;<br>        role: "user",&para;<br>        content: [&para;<br>          {&para;<br>            type: "tool_result" as const,&para;<br>            tool_use_id: response.content[0].id,&para;<br>            content: toolResult  // Search results go here&para;<br>          }&para;<br>        ]&para;<br>      }&para;<br>    ]&para;<br>  });&para;<br>}&para;<br>```&para;<br>&lt;/CodeGroup&gt;&para;<br>&para;<br>## Method 2: Search results as top-level content&para;<br>&para;<br>You can also provide search results directly in user messages. This is useful for:&para;<br>- Pre-fetched content from your search infrastructure&para;<br>- Cached search results from previous queries&para;<br>- Content from external search services&para;<br>- Testing and development&para;<br>&para;<br>### Example: Direct search results&para;<br>&para;<br>&lt;CodeGroup&gt;&para;<br>```python Python&para;<br>from anthropic import Anthropic&para;<br>from anthropic.types import (&para;<br>    MessageParam,&para;<br>    TextBlockParam,&para;<br>    SearchResultBlockParam&para;<br>)&para;<br>&para;<br>client = Anthropic()&para;<br>&para;<br># Provide search results directly in the user message&para;<br>response = client.messages.create(&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    max_tokens=1024,&para;<br>    messages=[&para;<br>        MessageParam(&para;<br>            role="user",&para;<br>            content=[&para;<br>                SearchResultBlockParam(&para;<br>                    type="search_result",&para;<br>                    source="https://docs.company.com/api-reference",&para;<br>                    title="API Reference - Authentication",&para;<br>                    content=[&para;<br>                        TextBlockParam(&para;<br>                            type="text",&para;<br>                            text="All API requests must include an API key in the Authorization header. Keys can be generated from the dashboard. Rate limits: 1000 requests per hour for standard tier, 10000 for premium."&para;<br>                        )&para;<br>                    ],&para;<br>                    citations={"enabled": True}&para;<br>                ),&para;<br>                SearchResultBlockParam(&para;<br>                    type="search_result",&para;<br>                    source="https://docs.company.com/quickstart",&para;<br>                    title="Getting Started Guide",&para;<br>                    content=[&para;<br>                        TextBlockParam(&para;<br>                            type="text",&para;<br>                            text="To get started: 1) Sign up for an account, 2) Generate an API key from the dashboard, 3) Install our SDK using pip install company-sdk, 4) Initialize the client with your API key."&para;<br>                        )&para;<br>                    ],&para;<br>                    citations={"enabled": True}&para;<br>                ),&para;<br>                TextBlockParam(&para;<br>                    type="text",&para;<br>                    text="Based on these search results, how do I authenticate API requests and what are the rate limits?"&para;<br>                )&para;<br>            ]&para;<br>        )&para;<br>    ]&para;<br>)&para;<br>&para;<br>print(response.model_dump_json(indent=2))&para;<br>```&para;<br>&para;<br>```typescript TypeScript&para;<br>import { Anthropic } from '@anthropic-ai/sdk';&para;<br>&para;<br>const anthropic = new Anthropic();&para;<br>&para;<br>// Provide search results directly in the user message&para;<br>const response = await anthropic.messages.create({&para;<br>  model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>  max_tokens: 1024,&para;<br>  messages: [&para;<br>    {&para;<br>      role: "user",&para;<br>      content: [&para;<br>        {&para;<br>          type: "search_result" as const,&para;<br>          source: "https://docs.company.com/api-reference",&para;<br>          title: "API Reference - Authentication",&para;<br>          content: [&para;<br>            {&para;<br>              type: "text" as const,&para;<br>              text: "All API requests must include an API key in the Authorization header. Keys can be generated from the dashboard. Rate limits: 1000 requests per hour for standard tier, 10000 for premium."&para;<br>            }&para;<br>          ],&para;<br>          citations: { enabled: true }&para;<br>        },&para;<br>        {&para;<br>          type: "search_result" as const,&para;<br>          source: "https://docs.company.com/quickstart",&para;<br>          title: "Getting Started Guide",&para;<br>          content: [&para;<br>            {&para;<br>              type: "text" as const,&para;<br>              text: "To get started: 1) Sign up for an account, 2) Generate an API key from the dashboard, 3) Install our SDK using pip install company-sdk, 4) Initialize the client with your API key."&para;<br>            }&para;<br>          ],&para;<br>          citations: { enabled: true }&para;<br>        },&para;<br>        {&para;<br>          type: "text" as const,&para;<br>          text: "Based on these search results, how do I authenticate API requests and what are the rate limits?"&para;<br>        }&para;<br>      ]&para;<br>    }&para;<br>  ]&para;<br>});&para;<br>&para;<br>console.log(response);&para;<br>```&para;<br>&para;<br>```bash Shell&para;<br>#!/bin/sh&para;<br>curl https://api.anthropic.com/v1/messages \&para;<br>     --header "x-api-key: $ANTHROPIC_API_KEY" \&para;<br>     --header "anthropic-version: 2023-06-01" \&para;<br>     --header "content-type: application/json" \&para;<br>     --data \&para;<br>'{&para;<br>    "model": "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    "max_tokens": 1024,&para;<br>    "messages": [&para;<br>        {&para;<br>            "role": "user",&para;<br>            "content": [&para;<br>                {&para;<br>                    "type": "search_result",&para;<br>                    "source": "https://docs.company.com/api-reference",&para;<br>                    "title": "API Reference - Authentication",&para;<br>                    "content": [&para;<br>                        {&para;<br>                            "type": "text",&para;<br>                            "text": "All API requests must include an API key in the Authorization header. Keys can be generated from the dashboard. Rate limits: 1000 requests per hour for standard tier, 10000 for premium."&para;<br>                        }&para;<br>                    ],&para;<br>                    "citations": {&para;<br>                        "enabled": true&para;<br>                    }&para;<br>                },&para;<br>                {&para;<br>                    "type": "search_result",&para;<br>                    "source": "https://docs.company.com/quickstart",&para;<br>                    "title": "Getting Started Guide",&para;<br>                    "content": [&para;<br>                        {&para;<br>                            "type": "text",&para;<br>                            "text": "To get started: 1) Sign up for an account, 2) Generate an API key from the dashboard, 3) Install our SDK using pip install company-sdk, 4) Initialize the client with your API key."&para;<br>                        }&para;<br>                    ],&para;<br>                    "citations": {&para;<br>                        "enabled": true&para;<br>                    }&para;<br>                },&para;<br>                {&para;<br>                    "type": "text",&para;<br>                    "text": "Based on these search results, how do I authenticate API requests and what are the rate limits?"&para;<br>                }&para;<br>            ]&para;<br>        }&para;<br>    ]&para;<br>}'&para;<br>```&para;<br>&lt;/CodeGroup&gt;&para;<br>&para;<br>## Claude's response with citations&para;<br>&para;<br>Regardless of how search results are provided, Claude automatically includes citations when using information from them:&para;<br>&para;<br>```json&para;<br>{&para;<br>  "role": "assistant",&para;<br>  "content": [&para;<br>    {&para;<br>      "type": "text",&para;<br>      "text": "To authenticate API requests, you need to include an API key in the Authorization header",&para;<br>      "citations": [&para;<br>        {&para;<br>          "type": "search_result_location",&para;<br>          "source": "https://docs.company.com/api-reference",&para;<br>          "title": "API Reference - Authentication",&para;<br>          "cited_text": "All API requests must include an API key in the Authorization header",&para;<br>          "search_result_index": 0,&para;<br>          "start_block_index": 0,&para;<br>          "end_block_index": 0&para;<br>        }&para;<br>      ]&para;<br>    },&para;<br>    {&para;<br>      "type": "text",&para;<br>      "text": ". You can generate API keys from your dashboard",&para;<br>      "citations": [&para;<br>        {&para;<br>          "type": "search_result_location",&para;<br>          "source": "https://docs.company.com/api-reference",&para;<br>          "title": "API Reference - Authentication",&para;<br>          "cited_text": "Keys can be generated from the dashboard",&para;<br>          "search_result_index": 0,&para;<br>          "start_block_index": 0,&para;<br>          "end_block_index": 0&para;<br>        }&para;<br>      ]&para;<br>    },&para;<br>    {&para;<br>      "type": "text",&para;<br>      "text": ". The rate limits are 1,000 requests per hour for the standard tier and 10,000 requests per hour for the premium tier.",&para;<br>      "citations": [&para;<br>        {&para;<br>          "type": "search_result_location",&para;<br>          "source": "https://docs.company.com/api-reference",&para;<br>          "title": "API Reference - Authentication",&para;<br>          "cited_text": "Rate limits: 1000 requests per hour for standard tier, 10000 for premium",&para;<br>          "search_result_index": 0,&para;<br>          "start_block_index": 0,&para;<br>          "end_block_index": 0&para;<br>        }&para;<br>      ]&para;<br>    }&para;<br>  ]&para;<br>}&para;<br>```&para;<br>&para;<br>### Citation fields&para;<br>&para;<br>Each citation includes:&para;<br>&para;<br>| Field | Type | Description |&para;<br>|-------|------|-------------|&para;<br>| `type` | string | Always `"search_result_location"` for search result citations |&para;<br>| `source` | string | The source from the original search result |&para;<br>| `title` | string or null | The title from the original search result |&para;<br>| `cited_text` | string | The exact text being cited |&para;<br>| `search_result_index` | integer | Index of the search result (0-based) |&para;<br>| `start_block_index` | integer | Starting position in the content array |&para;<br>| `end_block_index` | integer | Ending position in the content array |&para;<br>&para;<br>Note: The `search_result_index` refers to the index of the search result content block (0-based), regardless of how the search results were provided (tool call or top-level content).&para;<br>&para;<br>## Multiple content blocks&para;<br>&para;<br>Search results can contain multiple text blocks in the `content` array:&para;<br>&para;<br>```json&para;<br>{&para;<br>  "type": "search_result",&para;<br>  "source": "https://docs.company.com/api-guide",&para;<br>  "title": "API Documentation",&para;<br>  "content": [&para;<br>    {&para;<br>      "type": "text",&para;<br>      "text": "Authentication: All API requests require an API key."&para;<br>    },&para;<br>    {&para;<br>      "type": "text",&para;<br>      "text": "Rate Limits: The API allows 1000 requests per hour per key."&para;<br>    },&para;<br>    {&para;<br>      "type": "text",&para;<br>      "text": "Error Handling: The API returns standard HTTP status codes."&para;<br>    }&para;<br>  ]&para;<br>}&para;<br>```&para;<br>&para;<br>Claude can cite specific blocks using the `start_block_index` and `end_block_index` fields.&para;<br>&para;<br>## Advanced usage&para;<br>&para;<br>### Combining both methods&para;<br>&para;<br>You can use both tool-based and top-level search results in the same conversation:&para;<br>&para;<br>```python&para;<br># First message with top-level search results&para;<br>messages = [&para;<br>    MessageParam(&para;<br>        role="user",&para;<br>        content=[&para;<br>            SearchResultBlockParam(&para;<br>                type="search_result",&para;<br>                source="https://docs.company.com/overview",&para;<br>                title="Product Overview",&para;<br>                content=[&para;<br>                    TextBlockParam(type="text", text="Our product helps teams collaborate...")&para;<br>                ],&para;<br>                citations={"enabled": True}&para;<br>            ),&para;<br>            TextBlockParam(&para;<br>                type="text",&para;<br>                text="Tell me about this product and search for pricing information"&para;<br>            )&para;<br>        ]&para;<br>    )&para;<br>]&para;<br>&para;<br># Claude might respond and call a tool to search for pricing&para;<br># Then you provide tool results with more search results&para;<br>```&para;<br>&para;<br>### Combining with other content types&para;<br>&para;<br>Both methods support mixing search results with other content:&para;<br>&para;<br>```python&para;<br># In tool results&para;<br>tool_result = [&para;<br>    SearchResultBlockParam(&para;<br>        type="search_result",&para;<br>        source="https://docs.company.com/guide",&para;<br>        title="User Guide",&para;<br>        content=[TextBlockParam(type="text", text="Configuration details...")],&para;<br>        citations={"enabled": True}&para;<br>    ),&para;<br>    TextBlockParam(&para;<br>        type="text",&para;<br>        text="Additional context: This applies to version 2.0 and later."&para;<br>    )&para;<br>]&para;<br>&para;<br># In top-level content&para;<br>user_content = [&para;<br>    SearchResultBlockParam(&para;<br>        type="search_result",&para;<br>        source="https://research.com/paper",&para;<br>        title="Research Paper",&para;<br>        content=[TextBlockParam(type="text", text="Key findings...")],&para;<br>        citations={"enabled": True}&para;<br>    ),&para;<br>    {&para;<br>        "type": "image",&para;<br>        "source": {"type": "url", "url": "https://example.com/chart.png"}&para;<br>    },&para;<br>    TextBlockParam(&para;<br>        type="text",&para;<br>        text="How does the chart relate to the research findings?"&para;<br>    )&para;<br>]&para;<br>```&para;<br>&para;<br>### Cache control&para;<br>&para;<br>Add cache control for better performance:&para;<br>&para;<br>```json&para;<br>{&para;<br>  "type": "search_result",&para;<br>  "source": "https://docs.company.com/guide",&para;<br>  "title": "User Guide",&para;<br>  "content": [{"type": "text", "text": "..."}],&para;<br>  "cache_control": {&para;<br>    "type": "ephemeral"&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>### Citation control&para;<br>&para;<br>By default, citations are disabled for search results. You can enable citations by explicitly setting the `citations` configuration:&para;<br>&para;<br>```json&para;<br>{&para;<br>  "type": "search_result",&para;<br>  "source": "https://docs.company.com/guide",&para;<br>  "title": "User Guide",&para;<br>  "content": [{"type": "text", "text": "Important documentation..."}],&para;<br>  "citations": {&para;<br>    "enabled": true  // Enable citations for this result&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>When `citations.enabled` is set to `true`, Claude will include citation references when using information from the search result. This enables:&para;<br>- Natural citations for your custom RAG applications&para;<br>- Source attribution when interfacing with proprietary knowledge bases&para;<br>- Web search-quality citations for any custom tool that returns search results&para;<br>&para;<br>If the `citations` field is omitted, citations are disabled by default.&para;<br>&para;<br>&lt;Warning&gt;&para;<br>Citations are all-or-nothing: either all search results in a request must have citations enabled, or all must have them disabled. Mixing search results with different citation settings will result in an error. If you need to disable citations for some sources, you must disable them for all search results in that request.&para;<br>&lt;/Warning&gt;&para;<br>&para;<br>## Best practices&para;<br>&para;<br>### For tool-based search (Method 1)&para;<br>&para;<br>- **Dynamic content**: Use for real-time searches and dynamic RAG applications&para;<br>- **Error handling**: Return appropriate messages when searches fail&para;<br>- **Result limits**: Return only the most relevant results to avoid context overflow&para;<br>&para;<br>### For top-level search (Method 2)&para;<br>&para;<br>- **Pre-fetched content**: Use when you already have search results&para;<br>- **Batch processing**: Ideal for processing multiple search results at once&para;<br>- **Testing**: Great for testing citation behavior with known content&para;<br>&para;<br>### General best practices&para;<br>&para;<br>1. **Structure results effectively**&para;<br>   - Use clear, permanent source URLs&para;<br>   - Provide descriptive titles&para;<br>   - Break long content into logical text blocks&para;<br>&para;<br>2. **Maintain consistency**&para;<br>   - Use consistent source formats across your application&para;<br>   - Ensure titles accurately reflect content&para;<br>   - Keep formatting consistent&para;<br>&para;<br>3. **Handle errors gracefully**&para;<br>   ```python&para;<br>   def search_with_fallback(query):&para;<br>       try:&para;<br>           results = perform_search(query)&para;<br>           if not results:&para;<br>               return {"type": "text", "text": "No results found."}&para;<br>           return format_as_search_results(results)&para;<br>       except Exception as e:&para;<br>           return {"type": "text", "text": f"Search error: {str(e)}"}&para;<br>   ```&para;<br>&para;<br>## Limitations&para;<br>&para;<br>- Search result content blocks are available on Claude API, Amazon Bedrock, and Google Cloud's Vertex AI&para;<br>- Only text content is supported within search results (no images or other media)&para;<br>- The `content` array must contain at least one text block</span></div>
        </div>

        <h2 style="margin-top: 2rem; margin-bottom: 1rem;">Unified Diff</h2>
        <pre><code>--- a/build-with-claude/search-results.md
+++ b/build-with-claude/search-results.md
@@ -8,10 +8,11 @@
 
 The search results feature is available on the following models:
 
+- Claude Opus 4.6 (`claude-opus-4-6`)
+- Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`)
 - Claude Opus 4.5 (`claude-opus-4-5-20251101`)
 - Claude Opus 4.1 (`claude-opus-4-1-20250805`)
 - Claude Opus 4 (`claude-opus-4-20250514`)
-- Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`)
 - Claude Sonnet 4 (`claude-sonnet-4-20250514`)
 - Claude Sonnet 3.7 ([deprecated](/docs/en/about-claude/model-deprecations)) (`claude-3-7-sonnet-20250219`)
 - Claude Haiku 4.5 (`claude-haiku-4-5-20251001`)
@@ -142,7 +143,7 @@
 
 # Create a message with the tool
 response = client.messages.create(
-    model=&#34;claude-sonnet-4-5&#34;,  # Works with all supported models
+    model=&#34;claude-opus-4-6&#34;,  # Works with all supported models
     max_tokens=1024,
     tools=[knowledge_base_tool],
     messages=[
@@ -159,7 +160,7 @@
     
     # Send the tool result back
     final_response = client.messages.create(
-        model=&#34;claude-sonnet-4-5&#34;,  # Works with all supported models
+        model=&#34;claude-opus-4-6&#34;,  # Works with all supported models
         max_tokens=1024,
         messages=[
             MessageParam(role=&#34;user&#34;, content=&#34;How do I configure the timeout settings?&#34;),
@@ -233,7 +234,7 @@
 
 // Create a message with the tool
 const response = await anthropic.messages.create({
-  model: &#34;claude-sonnet-4-5&#34;, // Works with all supported models
+  model: &#34;claude-opus-4-6&#34;, // Works with all supported models
   max_tokens: 1024,
   tools: [knowledgeBaseTool],
   messages: [
@@ -249,7 +250,7 @@
   const toolResult = searchKnowledgeBase(response.content[0].input.query);
   
   const finalResponse = await anthropic.messages.create({
-    model: &#34;claude-sonnet-4-5&#34;, // Works with all supported models
+    model: &#34;claude-opus-4-6&#34;, // Works with all supported models
     max_tokens: 1024,
       messages: [
       { role: &#34;user&#34;, content: &#34;How do I configure the timeout settings?&#34; },
@@ -293,7 +294,7 @@
 
 # Provide search results directly in the user message
 response = client.messages.create(
-    model=&#34;claude-sonnet-4-5&#34;,
+    model=&#34;claude-opus-4-6&#34;,
     max_tokens=1024,
     messages=[
         MessageParam(
@@ -342,7 +343,7 @@
 
 // Provide search results directly in the user message
 const response = await anthropic.messages.create({
-  model: &#34;claude-sonnet-4-5&#34;,
+  model: &#34;claude-opus-4-6&#34;,
   max_tokens: 1024,
   messages: [
     {
@@ -392,7 +393,7 @@
      --header &#34;content-type: application/json&#34; \
      --data \
 &#39;{
-    &#34;model&#34;: &#34;claude-sonnet-4-5&#34;,
+    &#34;model&#34;: &#34;claude-opus-4-6&#34;,
     &#34;max_tokens&#34;: 1024,
     &#34;messages&#34;: [
         {
</code></pre>
    </div>
</body>
</html>