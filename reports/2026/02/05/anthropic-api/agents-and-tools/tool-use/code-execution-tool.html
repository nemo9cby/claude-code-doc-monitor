<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>agents-and-tools/tool-use/code-execution-tool - Diff Report</title>
    <link rel="stylesheet" href="../../css/diff.css">
    <style>
        :root {
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --text-color: #eee;
            --accent: #0f3460;
            --add-bg: #1a4d1a;
            --del-bg: #4d1a1a;
            --add-text: #4ade80;
            --del-text: #f87171;
        }
        @media (prefers-color-scheme: light) {
            :root {
                --bg-color: #f5f5f5;
                --card-bg: #fff;
                --text-color: #333;
                --accent: #e0e0e0;
                --add-bg: #d4edda;
                --del-bg: #f8d7da;
                --add-text: #155724;
                --del-text: #721c24;
            }
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 2rem;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        header { margin-bottom: 2rem; }
        h1 { font-size: 1.5rem; margin-bottom: 0.5rem; }
        .meta { color: #888; font-size: 0.9rem; }
        .summary {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            display: flex;
            gap: 2rem;
        }
        .stat { display: flex; align-items: center; gap: 0.5rem; }
        .stat.added { color: var(--add-text); }
        .stat.removed { color: var(--del-text); }
        .analysis {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            border-left: 4px solid #8b5cf6;
        }
        .analysis-header {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #8b5cf6;
        }
        .analysis-content {
            white-space: pre-wrap;
            font-size: 0.95rem;
            line-height: 1.7;
        }
        .diff-container {
            background: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
        }
        .diff-header {
            background: var(--accent);
            padding: 0.75rem 1rem;
            font-weight: 600;
        }
        .diff-content {
            padding: 1rem;
            overflow-x: auto;
        }
        .diff-content ins {
            background: var(--add-bg);
            color: var(--add-text);
            text-decoration: none;
            padding: 0.1em 0.2em;
            border-radius: 2px;
        }
        .diff-content del {
            background: var(--del-bg);
            color: var(--del-text);
            text-decoration: line-through;
            padding: 0.1em 0.2em;
            border-radius: 2px;
        }
        pre {
            background: var(--accent);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
            margin-top: 2rem;
        }
        a { color: #60a5fa; }
        .back-link { margin-bottom: 1rem; display: inline-block; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../../index.html" class="back-link">&larr; Back to daily report</a>

        <header>
            <h1>agents-and-tools/tool-use/code-execution-tool.md</h1>
            <p class="meta">Changed on 2026-02-05 12:43:36 EST</p>
        </header>

        <div class="summary">
            <div class="stat added">
                <span>+5</span> lines added
            </div>
            <div class="stat removed">
                <span>-4</span> lines removed
            </div>
        </div>

        

        <div class="diff-container">
            <div class="diff-header">Visual Diff</div>
            <div class="diff-content"><span># Code execution tool&para;<br>&para;<br>---&para;<br>&para;<br>Claude can analyze data, create visualizations, perform complex calculations, run system commands, create and edit files, and process uploaded&para;<br>files directly within the API conversation.&para;<br>The code execution tool allows Claude to run Bash commands and manipulate files, including writing code, in a secure, sandboxed environment.&para;<br>&para;<br>&lt;Note&gt;&para;<br>The code execution tool is currently in public beta.&para;<br>&para;<br>To use this feature, add the `"code-execution-2025-08-25"` [beta header](/docs/en/api/beta-headers) to your API requests.&para;<br>&para;<br>Please reach out through our [feedback form](https://forms.gle/LTAU6Xn2puCJMi1n6) to share your feedback on this feature.&para;<br>&lt;/Note&gt;&para;<br>&para;<br>## Model compatibility&para;<br>&para;<br>The code execution tool is available on the following models:&para;<br>&para;<br>| Model | Tool Version |&para;<br>|-------|--------------|&para;<br></span><ins style="background:#e6ffe6;">| Claude Opus 4.6 (`claude-opus-4-6`) | `code_execution_20250825` |&para;<br>| Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`) | `code_execution_20250825` |&para;<br></ins><span>| Claude Opus 4.5 (`claude-opus-4-5-20251101`) | `code_execution_20250825` |&para;<br></span><span>| Claude Opus 4.1 (`claude-opus-4-1-20250805`) | `code_execution_20250825` |&para;<br>| Claude Opus 4 (`claude-opus-4-20250514`) | `code_execution_20250825` |&para;<br></span><del style="background:#ffe6e6;">| Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`) | `code_execution_20250825` |&para;<br></del><span>| Claude Sonnet 4 (`claude-sonnet-4-20250514`) | `code_execution_20250825` |&para;<br>| Claude Sonnet 3.7 (`claude-3-7-sonnet-20250219`) ([deprecated](/docs/en/about-claude/model-deprecations)) | `code_execution_20250825` |&para;<br>| Claude Haiku 4.5 (`claude-haiku-4-5-20251001`) | `code_execution_20250825` |&para;<br>| Claude Haiku 3.5 (`claude-3-5-haiku-latest`) ([deprecated](/docs/en/about-claude/model-deprecations)) | `code_execution_20250825` |&para;<br>&para;<br>&lt;Note&gt;&para;<br>The current version `code_execution_20250825` supports Bash commands and file operations. A legacy version `code_execution_20250522` (Python only) is also available. See [Upgrade to latest tool version](#upgrade-to-latest-tool-version) for migration details.&para;<br>&lt;/Note&gt;&para;<br>&para;<br>&lt;Warning&gt;&para;<br>Older tool versions are not guaranteed to be backwards-compatible with newer models. Always use the tool version that corresponds to your model version.&para;<br>&lt;/Warning&gt;&para;<br>&para;<br>## Quick start&para;<br>&para;<br>Here's a simple example that asks Claude to perform a calculation:&para;<br>&para;<br>&lt;CodeGroup&gt;&para;<br>```bash Shell&para;<br>curl https://api.anthropic.com/v1/messages \&para;<br>    --header "x-api-key: $ANTHROPIC_API_KEY" \&para;<br>    --header "anthropic-version: 2023-06-01" \&para;<br>    --header "anthropic-beta: code-execution-2025-08-25" \&para;<br>    --header "content-type: application/json" \&para;<br>    --data '{&para;<br>        "model": "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>        "max_tokens": 4096,&para;<br>        "messages": [&para;<br>            {&para;<br>                "role": "user",&para;<br>                "content": "Calculate the mean and standard deviation of [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]"&para;<br>            }&para;<br>        ],&para;<br>        "tools": [{&para;<br>            "type": "code_execution_20250825",&para;<br>            "name": "code_execution"&para;<br>        }]&para;<br>    }'&para;<br>```&para;<br>&para;<br>```python Python&para;<br>import anthropic&para;<br>&para;<br>client = anthropic.Anthropic()&para;<br>&para;<br>response = client.beta.messages.create(&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas=["code-execution-2025-08-25"],&para;<br>    max_tokens=4096,&para;<br>    messages=[{&para;<br>        "role": "user",&para;<br>        "content": "Calculate the mean and standard deviation of [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]"&para;<br>    }],&para;<br>    tools=[{&para;<br>        "type": "code_execution_20250825",&para;<br>        "name": "code_execution"&para;<br>    }]&para;<br>)&para;<br>&para;<br>print(response)&para;<br>```&para;<br>&para;<br>```typescript TypeScript&para;<br>import { Anthropic } from '@anthropic-ai/sdk';&para;<br>&para;<br>const anthropic = new Anthropic();&para;<br>&para;<br>async function main() {&para;<br>  const response = await anthropic.beta.messages.create({&para;<br>    model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas: ["code-execution-2025-08-25"],&para;<br>    max_tokens: 4096,&para;<br>    messages: [&para;<br>      {&para;<br>        role: "user",&para;<br>        content: "Calculate the mean and standard deviation of [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]"&para;<br>      }&para;<br>    ],&para;<br>    tools: [{&para;<br>      type: "code_execution_20250825",&para;<br>      name: "code_execution"&para;<br>    }]&para;<br>  });&para;<br>&para;<br>  console.log(response);&para;<br>}&para;<br>&para;<br>main().catch(console.error);&para;<br>```&para;<br>&lt;/CodeGroup&gt;&para;<br>&para;<br>## How code execution works&para;<br>&para;<br>When you add the code execution tool to your API request:&para;<br>&para;<br>1. Claude evaluates whether code execution would help answer your question&para;<br>2. The tool automatically provides Claude with the following capabilities:&para;<br>   - **Bash commands**: Execute shell commands for system operations and package management&para;<br>   - **File operations**: Create, view, and edit files directly, including writing code&para;<br>3. Claude can use any combination of these capabilities in a single request&para;<br>4. All operations run in a secure sandbox environment&para;<br>5. Claude provides results with any generated charts, calculations, or analysis&para;<br>&para;<br>## How to use the tool&para;<br>&para;<br>### Execute Bash commands&para;<br>&para;<br>Ask Claude to check system information and install packages:&para;<br>&para;<br>&lt;CodeGroup&gt;&para;<br>```bash Shell&para;<br>curl https://api.anthropic.com/v1/messages \&para;<br>    --header "x-api-key: $ANTHROPIC_API_KEY" \&para;<br>    --header "anthropic-version: 2023-06-01" \&para;<br>    --header "anthropic-beta: code-execution-2025-08-25" \&para;<br>    --header "content-type: application/json" \&para;<br>    --data '{&para;<br>        "model": "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>        "max_tokens": 4096,&para;<br>        "messages": [{&para;<br>            "role": "user",&para;<br>            "content": "Check the Python version and list installed packages"&para;<br>        }],&para;<br>        "tools": [{&para;<br>            "type": "code_execution_20250825",&para;<br>            "name": "code_execution"&para;<br>        }]&para;<br>    }'&para;<br>```&para;<br>&para;<br>```python Python&para;<br>response = client.beta.messages.create(&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas=["code-execution-2025-08-25"],&para;<br>    max_tokens=4096,&para;<br>    messages=[{&para;<br>        "role": "user",&para;<br>        "content": "Check the Python version and list installed packages"&para;<br>    }],&para;<br>    tools=[{&para;<br>        "type": "code_execution_20250825",&para;<br>        "name": "code_execution"&para;<br>    }]&para;<br>)&para;<br>```&para;<br>&para;<br>```typescript TypeScript&para;<br>const response = await anthropic.beta.messages.create({&para;<br>  model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>  betas: ["code-execution-2025-08-25"],&para;<br>  max_tokens: 4096,&para;<br>  messages: [{&para;<br>    role: "user",&para;<br>    content: "Check the Python version and list installed packages"&para;<br>  }],&para;<br>  tools: [{&para;<br>    type: "code_execution_20250825",&para;<br>    name: "code_execution"&para;<br>  }]&para;<br>});&para;<br>```&para;<br>&lt;/CodeGroup&gt;&para;<br>&para;<br>### Create and edit files directly&para;<br>&para;<br>Claude can create, view, and edit files directly in the sandbox using the file manipulation capabilities:&para;<br>&para;<br>&lt;CodeGroup&gt;&para;<br>```bash Shell&para;<br>curl https://api.anthropic.com/v1/messages \&para;<br>    --header "x-api-key: $ANTHROPIC_API_KEY" \&para;<br>    --header "anthropic-version: 2023-06-01" \&para;<br>    --header "anthropic-beta: code-execution-2025-08-25" \&para;<br>    --header "content-type: application/json" \&para;<br>    --data '{&para;<br>        "model": "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>        "max_tokens": 4096,&para;<br>        "messages": [{&para;<br>            "role": "user",&para;<br>            "content": "Create a config.yaml file with database settings, then update the port from 5432 to 3306"&para;<br>        }],&para;<br>        "tools": [{&para;<br>            "type": "code_execution_20250825",&para;<br>            "name": "code_execution"&para;<br>        }]&para;<br>    }'&para;<br>```&para;<br>&para;<br>```python Python&para;<br>response = client.beta.messages.create(&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas=["code-execution-2025-08-25"],&para;<br>    max_tokens=4096,&para;<br>    messages=[{&para;<br>        "role": "user",&para;<br>        "content": "Create a config.yaml file with database settings, then update the port from 5432 to 3306"&para;<br>    }],&para;<br>    tools=[{&para;<br>        "type": "code_execution_20250825",&para;<br>        "name": "code_execution"&para;<br>    }]&para;<br>)&para;<br>```&para;<br>&para;<br>```typescript TypeScript&para;<br>const response = await anthropic.beta.messages.create({&para;<br>  model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>  betas: ["code-execution-2025-08-25"],&para;<br>  max_tokens: 4096,&para;<br>  messages: [{&para;<br>    role: "user",&para;<br>    content: "Create a config.yaml file with database settings, then update the port from 5432 to 3306"&para;<br>  }],&para;<br>  tools: [{&para;<br>    type: "code_execution_20250825",&para;<br>    name: "code_execution"&para;<br>  }]&para;<br>});&para;<br>```&para;<br>&lt;/CodeGroup&gt;&para;<br>&para;<br>### Upload and analyze your own files&para;<br>&para;<br>To analyze your own data files (CSV, Excel, images, etc.), upload them via the Files API and reference them in your request:&para;<br>&para;<br>&lt;Note&gt;&para;<br>Using the Files API with Code Execution requires two beta headers: `"anthropic-beta": "code-execution-2025-08-25,files-api-2025-04-14"`&para;<br>&lt;/Note&gt;&para;<br>&para;<br>The Python environment can process various file types uploaded via the Files API, including:&para;<br>&para;<br>- CSV&para;<br>- Excel (.xlsx, .xls)&para;<br>- JSON&para;<br>- XML&para;<br>- Images (JPEG, PNG, GIF, WebP)&para;<br>- Text files (.txt, .md, .py, etc)&para;<br>&para;<br>#### Upload and analyze files&para;<br>&para;<br>1. **Upload your file** using the [Files API](/docs/en/build-with-claude/files)&para;<br>2. **Reference the file** in your message using a `container_upload` content block&para;<br>3. **Include the code execution tool** in your API request&para;<br>&para;<br>&lt;CodeGroup&gt;&para;<br>```bash Shell&para;<br># First, upload a file&para;<br>curl https://api.anthropic.com/v1/files \&para;<br>    --header "x-api-key: $ANTHROPIC_API_KEY" \&para;<br>    --header "anthropic-version: 2023-06-01" \&para;<br>    --header "anthropic-beta: files-api-2025-04-14" \&para;<br>    --form 'file=@"data.csv"' \&para;<br>&para;<br># Then use the file_id with code execution&para;<br>curl https://api.anthropic.com/v1/messages \&para;<br>    --header "x-api-key: $ANTHROPIC_API_KEY" \&para;<br>    --header "anthropic-version: 2023-06-01" \&para;<br>    --header "anthropic-beta: code-execution-2025-08-25,files-api-2025-04-14" \&para;<br>    --header "content-type: application/json" \&para;<br>    --data '{&para;<br>        "model": "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>        "max_tokens": 4096,&para;<br>        "messages": [{&para;<br>            "role": "user",&para;<br>            "content": [&para;<br>                {"type": "text", "text": "Analyze this CSV data"},&para;<br>                {"type": "container_upload", "file_id": "file_abc123"}&para;<br>            ]&para;<br>        }],&para;<br>        "tools": [{&para;<br>            "type": "code_execution_20250825",&para;<br>            "name": "code_execution"&para;<br>        }]&para;<br>    }'&para;<br>```&para;<br>&para;<br>```python Python&para;<br>import anthropic&para;<br>&para;<br>client = anthropic.Anthropic()&para;<br>&para;<br># Upload a file&para;<br>file_object = client.beta.files.upload(&para;<br>    file=open("data.csv", "rb"),&para;<br>)&para;<br>&para;<br># Use the file_id with code execution&para;<br>response = client.beta.messages.create(&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas=["code-execution-2025-08-25", "files-api-2025-04-14"],&para;<br>    max_tokens=4096,&para;<br>    messages=[{&para;<br>        "role": "user",&para;<br>        "content": [&para;<br>            {"type": "text", "text": "Analyze this CSV data"},&para;<br>            {"type": "container_upload", "file_id": file_object.id}&para;<br>        ]&para;<br>    }],&para;<br>    tools=[{&para;<br>        "type": "code_execution_20250825",&para;<br>        "name": "code_execution"&para;<br>    }]&para;<br>)&para;<br>```&para;<br>&para;<br>```typescript TypeScript&para;<br>import { Anthropic } from '@anthropic-ai/sdk';&para;<br>import { createReadStream } from 'fs';&para;<br>&para;<br>const anthropic = new Anthropic();&para;<br>&para;<br>async function main() {&para;<br>  // Upload a file&para;<br>  const fileObject = await anthropic.beta.files.create({&para;<br>    file: createReadStream("data.csv"),&para;<br>  });&para;<br>&para;<br>  // Use the file_id with code execution&para;<br>  const response = await anthropic.beta.messages.create({&para;<br>    model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas: ["code-execution-2025-08-25", "files-api-2025-04-14"],&para;<br>    max_tokens: 4096,&para;<br>    messages: [{&para;<br>      role: "user",&para;<br>      content: [&para;<br>        { type: "text", text: "Analyze this CSV data" },&para;<br>        { type: "container_upload", file_id: fileObject.id }&para;<br>      ]&para;<br>    }],&para;<br>    tools: [{&para;<br>      type: "code_execution_20250825",&para;<br>      name: "code_execution"&para;<br>    }]&para;<br>  });&para;<br>&para;<br>  console.log(response);&para;<br>}&para;<br>&para;<br>main().catch(console.error);&para;<br>```&para;<br>&lt;/CodeGroup&gt;&para;<br>&para;<br>#### Retrieve generated files&para;<br>&para;<br>When Claude creates files during code execution, you can retrieve these files using the Files API:&para;<br>&para;<br>&lt;CodeGroup&gt;&para;<br>```python Python&para;<br>from anthropic import Anthropic&para;<br>&para;<br># Initialize the client&para;<br>client = Anthropic()&para;<br>&para;<br># Request code execution that creates files&para;<br>response = client.beta.messages.create(&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas=["code-execution-2025-08-25", "files-api-2025-04-14"],&para;<br>    max_tokens=4096,&para;<br>    messages=[{&para;<br>        "role": "user",&para;<br>        "content": "Create a matplotlib visualization and save it as output.png"&para;<br>    }],&para;<br>    tools=[{&para;<br>        "type": "code_execution_20250825",&para;<br>        "name": "code_execution"&para;<br>    }]&para;<br>)&para;<br>&para;<br># Extract file IDs from the response&para;<br>def extract_file_ids(response):&para;<br>    file_ids = []&para;<br>    for item in response.content:&para;<br>        if item.type == 'bash_code_execution_tool_result':&para;<br>            content_item = item.content&para;<br>            if content_item.type == 'bash_code_execution_result':&para;<br>                for file in content_item.content:&para;<br>                    if hasattr(file, 'file_id'):&para;<br>                        file_ids.append(file.file_id)&para;<br>    return file_ids&para;<br>&para;<br># Download the created files&para;<br>for file_id in extract_file_ids(response):&para;<br>    file_metadata = client.beta.files.retrieve_metadata(file_id)&para;<br>    file_content = client.beta.files.download(file_id)&para;<br>    file_content.write_to_file(file_metadata.filename)&para;<br>    print(f"Downloaded: {file_metadata.filename}")&para;<br>```&para;<br>&para;<br>```typescript TypeScript&para;<br>import { Anthropic } from '@anthropic-ai/sdk';&para;<br>import { writeFileSync } from 'fs';&para;<br>&para;<br>// Initialize the client&para;<br>const anthropic = new Anthropic();&para;<br>&para;<br>async function main() {&para;<br>  // Request code execution that creates files&para;<br>  const response = await anthropic.beta.messages.create({&para;<br>    model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas: ["code-execution-2025-08-25", "files-api-2025-04-14"],&para;<br>    max_tokens: 4096,&para;<br>    messages: [{&para;<br>      role: "user",&para;<br>      content: "Create a matplotlib visualization and save it as output.png"&para;<br>    }],&para;<br>    tools: [{&para;<br>      type: "code_execution_20250825",&para;<br>      name: "code_execution"&para;<br>    }]&para;<br>  });&para;<br>&para;<br>  // Extract file IDs from the response&para;<br>  function extractFileIds(response: any): string[] {&para;<br>    const fileIds: string[] = [];&para;<br>    for (const item of response.content) {&para;<br>      if (item.type === 'bash_code_execution_tool_result') {&para;<br>        const contentItem = item.content;&para;<br>        if (contentItem.type === 'bash_code_execution_result' &amp;&amp; contentItem.content) {&para;<br>          for (const file of contentItem.content) {&para;<br>            fileIds.push(file.file_id);&para;<br>          }&para;<br>        }&para;<br>      }&para;<br>    }&para;<br>    return fileIds;&para;<br>  }&para;<br>&para;<br>  // Download the created files&para;<br>  const fileIds = extractFileIds(response);&para;<br>  for (const fileId of fileIds) {&para;<br>    const fileMetadata = await anthropic.beta.files.retrieveMetadata(fileId);&para;<br>    const fileContent = await anthropic.beta.files.download(fileId);&para;<br>&para;<br>    // Convert ReadableStream to Buffer and save&para;<br>    const chunks: Uint8Array[] = [];&para;<br>    for await (const chunk of fileContent) {&para;<br>      chunks.push(chunk);&para;<br>    }&para;<br>    const buffer = Buffer.concat(chunks);&para;<br>    writeFileSync(fileMetadata.filename, buffer);&para;<br>    console.log(`Downloaded: ${fileMetadata.filename}`);&para;<br>  }&para;<br>}&para;<br>&para;<br>main().catch(console.error);&para;<br>```&para;<br>&lt;/CodeGroup&gt;&para;<br>&para;<br>### Combine operations&para;<br>&para;<br>A complex workflow using all capabilities:&para;<br>&para;<br>&lt;CodeGroup&gt;&para;<br>```bash Shell&para;<br># First, upload a file&para;<br>curl https://api.anthropic.com/v1/files \&para;<br>    --header "x-api-key: $ANTHROPIC_API_KEY" \&para;<br>    --header "anthropic-version: 2023-06-01" \&para;<br>    --header "anthropic-beta: files-api-2025-04-14" \&para;<br>    --form 'file=@"data.csv"' \&para;<br>    &gt; file_response.json&para;<br>&para;<br># Extract file_id (using jq)&para;<br>FILE_ID=$(jq -r '.id' file_response.json)&para;<br>&para;<br># Then use it with code execution&para;<br>curl https://api.anthropic.com/v1/messages \&para;<br>    --header "x-api-key: $ANTHROPIC_API_KEY" \&para;<br>    --header "anthropic-version: 2023-06-01" \&para;<br>    --header "anthropic-beta: code-execution-2025-08-25,files-api-2025-04-14" \&para;<br>    --header "content-type: application/json" \&para;<br>    --data '{&para;<br>        "model": "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>        "max_tokens": 4096,&para;<br>        "messages": [{&para;<br>            "role": "user",&para;<br>            "content": [&para;<br>                {&para;<br>                    "type": "text", &para;<br>                    "text": "Analyze this CSV data: create a summary report, save visualizations, and create a README with the findings"&para;<br>                },&para;<br>                {&para;<br>                    "type": "container_upload", &para;<br>                    "file_id": "'$FILE_ID'"&para;<br>                }&para;<br>            ]&para;<br>        }],&para;<br>        "tools": [{&para;<br>            "type": "code_execution_20250825",&para;<br>            "name": "code_execution"&para;<br>        }]&para;<br>    }'&para;<br>```&para;<br>&para;<br>```python Python&para;<br># Upload a file&para;<br>file_object = client.beta.files.upload(&para;<br>    file=open("data.csv", "rb"),&para;<br>)&para;<br>&para;<br># Use it with code execution&para;<br>response = client.beta.messages.create(&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas=["code-execution-2025-08-25", "files-api-2025-04-14"],&para;<br>    max_tokens=4096,&para;<br>    messages=[{&para;<br>        "role": "user",&para;<br>        "content": [&para;<br>            {"type": "text", "text": "Analyze this CSV data: create a summary report, save visualizations, and create a README with the findings"},&para;<br>            {"type": "container_upload", "file_id": file_object.id}&para;<br>        ]&para;<br>    }],&para;<br>    tools=[{&para;<br>        "type": "code_execution_20250825",&para;<br>        "name": "code_execution"&para;<br>    }]&para;<br>)&para;<br>&para;<br># Claude might:&para;<br># 1. Use bash to check file size and preview data&para;<br># 2. Use text_editor to write Python code to analyze the CSV and create visualizations&para;<br># 3. Use bash to run the Python code&para;<br># 4. Use text_editor to create a README.md with findings&para;<br># 5. Use bash to organize files into a report directory&para;<br>```&para;<br>&para;<br>```typescript TypeScript&para;<br>// Upload a file&para;<br>const fileObject = await anthropic.beta.files.create({&para;<br>  file: createReadStream("data.csv"),&para;<br>});&para;<br>&para;<br>// Use it with code execution&para;<br>const response = await anthropic.beta.messages.create({&para;<br>  model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>  betas: ["code-execution-2025-08-25", "files-api-2025-04-14"],&para;<br>  max_tokens: 4096,&para;<br>  messages: [{&para;<br>    role: "user",&para;<br>    content: [&para;<br>      {type: "text", text: "Analyze this CSV data: create a summary report, save visualizations, and create a README with the findings"},&para;<br>      {type: "container_upload", file_id: fileObject.id}&para;<br>    ]&para;<br>  }],&para;<br>  tools: [{&para;<br>    type: "code_execution_20250825",&para;<br>    name: "code_execution"&para;<br>  }]&para;<br>});&para;<br>&para;<br>// Claude might:&para;<br>// 1. Use bash to check file size and preview data&para;<br>// 2. Use text_editor to write Python code to analyze the CSV and create visualizations&para;<br>// 3. Use bash to run the Python code&para;<br>// 4. Use text_editor to create a README.md with findings&para;<br>// 5. Use bash to organize files into a report directory&para;<br>```&para;<br>&lt;/CodeGroup&gt;&para;<br>&para;<br>## Tool definition&para;<br>&para;<br>The code execution tool requires no additional parameters:&para;<br>&para;<br>```json JSON&para;<br>{&para;<br>  "type": "code_execution_20250825",&para;<br>  "name": "code_execution"&para;<br>}&para;<br>```&para;<br>&para;<br>When this tool is provided, Claude automatically gains access to two sub-tools:&para;<br>- `bash_code_execution`: Run shell commands&para;<br>- `text_editor_code_execution`: View, create, and edit files, including writing code&para;<br>&para;<br>## Response format&para;<br>&para;<br>The code execution tool can return two types of results depending on the operation:&para;<br>&para;<br>### Bash command response&para;<br>&para;<br>```json&para;<br>{&para;<br>  "type": "server_tool_use",&para;<br>  "id": "srvtoolu_01B3C4D5E6F7G8H9I0J1K2L3",&para;<br>  "name": "bash_code_execution",&para;<br>  "input": {&para;<br>    "command": "ls -la | head -5"&para;<br>  }&para;<br>},&para;<br>{&para;<br>  "type": "bash_code_execution_tool_result",&para;<br>  "tool_use_id": "srvtoolu_01B3C4D5E6F7G8H9I0J1K2L3",&para;<br>  "content": {&para;<br>    "type": "bash_code_execution_result",&para;<br>    "stdout": "total 24\ndrwxr-xr-x 2 user user 4096 Jan 1 12:00 .\ndrwxr-xr-x 3 user user 4096 Jan 1 11:00 ..\n-rw-r--r-- 1 user user  220 Jan 1 12:00 data.csv\n-rw-r--r-- 1 user user  180 Jan 1 12:00 config.json",&para;<br>    "stderr": "",&para;<br>    "return_code": 0&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>### File operation responses&para;<br>&para;<br>**View file:**&para;<br>```json&para;<br>{&para;<br>  "type": "server_tool_use",&para;<br>  "id": "srvtoolu_01C4D5E6F7G8H9I0J1K2L3M4",&para;<br>  "name": "text_editor_code_execution",&para;<br>  "input": {&para;<br>    "command": "view",&para;<br>    "path": "config.json"&para;<br>  }&para;<br>},&para;<br>{&para;<br>  "type": "text_editor_code_execution_tool_result",&para;<br>  "tool_use_id": "srvtoolu_01C4D5E6F7G8H9I0J1K2L3M4",&para;<br>  "content": {&para;<br>    "type": "text_editor_code_execution_result",&para;<br>    "file_type": "text",&para;<br>    "content": "{\n  \"setting\": \"value\",\n  \"debug\": true\n}",&para;<br>    "numLines": 4,&para;<br>    "startLine": 1,&para;<br>    "totalLines": 4&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>**Create file:**&para;<br>```json&para;<br>{&para;<br>  "type": "server_tool_use",&para;<br>  "id": "srvtoolu_01D5E6F7G8H9I0J1K2L3M4N5",&para;<br>  "name": "text_editor_code_execution",&para;<br>  "input": {&para;<br>    "command": "create",&para;<br>    "path": "new_file.txt",&para;<br>    "file_text": "Hello, World!"&para;<br>  }&para;<br>},&para;<br>{&para;<br>  "type": "text_editor_code_execution_tool_result",&para;<br>  "tool_use_id": "srvtoolu_01D5E6F7G8H9I0J1K2L3M4N5",&para;<br>  "content": {&para;<br>    "type": "text_editor_code_execution_result",&para;<br>    "is_file_update": false&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>**Edit file (str_replace):**&para;<br>```json&para;<br>{&para;<br>  "type": "server_tool_use",&para;<br>  "id": "srvtoolu_01E6F7G8H9I0J1K2L3M4N5O6",&para;<br>  "name": "text_editor_code_execution",&para;<br>  "input": {&para;<br>    "command": "str_replace",&para;<br>    "path": "config.json",&para;<br>    "old_str": "\"debug\": true",&para;<br>    "new_str": "\"debug\": false"&para;<br>  }&para;<br>},&para;<br>{&para;<br>  "type": "text_editor_code_execution_tool_result",&para;<br>  "tool_use_id": "srvtoolu_01E6F7G8H9I0J1K2L3M4N5O6",&para;<br>  "content": {&para;<br>    "type": "text_editor_code_execution_result",&para;<br>    "oldStart": 3,&para;<br>    "oldLines": 1,&para;<br>    "newStart": 3,&para;<br>    "newLines": 1,&para;<br>    "lines": ["-  \"debug\": true", "+  \"debug\": false"]&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>### Results&para;<br>&para;<br>All execution results include:&para;<br>- `stdout`: Output from successful execution&para;<br>- `stderr`: Error messages if execution fails&para;<br>- `return_code`: 0 for success, non-zero for failure&para;<br>&para;<br>Additional fields for file operations:&para;<br>- **View**: `file_type`, `content`, `numLines`, `startLine`, `totalLines`&para;<br>- **Create**: `is_file_update` (whether file already existed)&para;<br>- **Edit**: `oldStart`, `oldLines`, `newStart`, `newLines`, `lines` (diff format)&para;<br>&para;<br>### Errors&para;<br>&para;<br>Each tool type can return specific errors:&para;<br>&para;<br>**Common errors (all tools):**&para;<br>```json&para;<br>{&para;<br>  "type": "bash_code_execution_tool_result",&para;<br>  "tool_use_id": "srvtoolu_01VfmxgZ46TiHbmXgy928hQR",&para;<br>  "content": {&para;<br>    "type": "bash_code_execution_tool_result_error",&para;<br>    "error_code": "unavailable"&para;<br>  }&para;<br>}&para;<br>```&para;<br>&para;<br>**Error codes by tool type:**&para;<br>&para;<br>| Tool | Error Code | Description |&para;<br>|------|-----------|-------------|&para;<br>| All tools | `unavailable` | The tool is temporarily unavailable |&para;<br>| All tools | `execution_time_exceeded` | Execution exceeded maximum time limit |&para;<br>| All tools | `container_expired` | Container expired and is no longer available |&para;<br>| All tools | `invalid_tool_input` | Invalid parameters provided to the tool |&para;<br>| All tools | `too_many_requests` | Rate limit exceeded for tool usage |&para;<br>| text_editor | `file_not_found` | File doesn't exist (for view/edit operations) |&para;<br>| text_editor | `string_not_found` | The `old_str` not found in file (for str_replace) |&para;<br>&para;<br>#### `pause_turn` stop reason&para;<br>&para;<br>The response may include a `pause_turn` stop reason, which indicates that the API paused a long-running turn. You may&para;<br>provide the response back as-is in a subsequent request to let Claude continue its turn, or modify the content if you&para;<br>wish to interrupt the conversation.&para;<br>&para;<br>## Containers&para;<br>&para;<br>The code execution tool runs in a secure, containerized environment designed specifically for code execution, with a higher focus on Python.&para;<br>&para;<br>### Runtime environment&para;<br>- **Python version**: 3.11.12&para;<br>- **Operating system**: Linux-based container&para;<br>- **Architecture**: x86_64 (AMD64)&para;<br>&para;<br>### Resource limits&para;<br>- **Memory**: 5GiB RAM&para;<br>- **Disk space**: 5GiB workspace storage&para;<br>- **CPU**: 1 CPU&para;<br>&para;<br>### Networking and security&para;<br>- **Internet access**: Completely disabled for security&para;<br>- **External connections**: No outbound network requests permitted&para;<br>- **Sandbox isolation**: Full isolation from host system and other containers&para;<br>- **File access**: Limited to workspace directory only&para;<br>- **Workspace scoping**: Like [Files](/docs/en/build-with-claude/files), containers are scoped to the workspace of the API key&para;<br>- **Expiration**: Containers expire 30 days after creation&para;<br>&para;<br>### Pre-installed libraries&para;<br>The sandboxed Python environment includes these commonly used libraries:&para;<br>- **Data Science**: pandas, numpy, scipy, scikit-learn, statsmodels&para;<br>- **Visualization**: matplotlib, seaborn&para;<br>- **File Processing**: pyarrow, openpyxl, xlsxwriter, xlrd, pillow, python-pptx, python-docx, pypdf, pdfplumber, pypdfium2, pdf2image, pdfkit, tabula-py, reportlab[pycairo], Img2pdf&para;<br>- **Math &amp; Computing**: sympy, mpmath&para;<br>- **Utilities**: tqdm, python-dateutil, pytz, joblib, unzip, unrar, 7zip, bc, rg (ripgrep), fd, sqlite&para;<br>&para;<br>## Container reuse&para;<br>&para;<br>You can reuse an existing container across multiple API requests by providing the container ID from a previous response.&para;<br>This allows you to maintain created files between requests.&para;<br>&para;<br>### Example&para;<br>&para;<br>&lt;CodeGroup&gt;&para;<br>```python Python&para;<br>import os&para;<br>from anthropic import Anthropic&para;<br>&para;<br># Initialize the client&para;<br>client = Anthropic(&para;<br>    api_key=os.getenv("ANTHROPIC_API_KEY")&para;<br>)&para;<br>&para;<br># First request: Create a file with a random number&para;<br>response1 = client.beta.messages.create(&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas=["code-execution-2025-08-25"],&para;<br>    max_tokens=4096,&para;<br>    messages=[{&para;<br>        "role": "user",&para;<br>        "content": "Write a file with a random number and save it to '/tmp/number.txt'"&para;<br>    }],&para;<br>    tools=[{&para;<br>        "type": "code_execution_20250825",&para;<br>        "name": "code_execution"&para;<br>    }]&para;<br>)&para;<br>&para;<br># Extract the container ID from the first response&para;<br>container_id = response1.container.id&para;<br>&para;<br># Second request: Reuse the container to read the file&para;<br>response2 = client.beta.messages.create(&para;<br>    container=container_id,  # Reuse the same container&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas=["code-execution-2025-08-25"],&para;<br>    max_tokens=4096,&para;<br>    messages=[{&para;<br>        "role": "user",&para;<br>        "content": "Read the number from '/tmp/number.txt' and calculate its square"&para;<br>    }],&para;<br>    tools=[{&para;<br>        "type": "code_execution_20250825",&para;<br>        "name": "code_execution"&para;<br>    }]&para;<br>)&para;<br>```&para;<br>&para;<br>```typescript TypeScript&para;<br>import { Anthropic } from '@anthropic-ai/sdk';&para;<br>&para;<br>const anthropic = new Anthropic();&para;<br>&para;<br>async function main() {&para;<br>  // First request: Create a file with a random number&para;<br>  const response1 = await anthropic.beta.messages.create({&para;<br>    model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas: ["code-execution-2025-08-25"],&para;<br>    max_tokens: 4096,&para;<br>    messages: [{&para;<br>      role: "user",&para;<br>      content: "Write a file with a random number and save it to '/tmp/number.txt'"&para;<br>    }],&para;<br>    tools: [{&para;<br>      type: "code_execution_20250825",&para;<br>      name: "code_execution"&para;<br>    }]&para;<br>  });&para;<br>&para;<br>  // Extract the container ID from the first response&para;<br>  const containerId = response1.container.id;&para;<br>&para;<br>  // Second request: Reuse the container to read the file&para;<br>  const response2 = await anthropic.beta.messages.create({&para;<br>    container: containerId,  // Reuse the same container&para;<br>    model: "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas: ["code-execution-2025-08-25"],&para;<br>    max_tokens: 4096,&para;<br>    messages: [{&para;<br>      role: "user",&para;<br>      content: "Read the number from '/tmp/number.txt' and calculate its square"&para;<br>    }],&para;<br>    tools: [{&para;<br>      type: "code_execution_20250825",&para;<br>      name: "code_execution"&para;<br>    }]&para;<br>  });&para;<br>&para;<br>  console.log(response2.content);&para;<br>}&para;<br>&para;<br>main().catch(console.error);&para;<br>```&para;<br>&para;<br>```bash Shell&para;<br># First request: Create a file with a random number&para;<br>curl https://api.anthropic.com/v1/messages \&para;<br>    --header "x-api-key: $ANTHROPIC_API_KEY" \&para;<br>    --header "anthropic-version: 2023-06-01" \&para;<br>    --header "anthropic-beta: code-execution-2025-08-25" \&para;<br>    --header "content-type: application/json" \&para;<br>    --data '{&para;<br>        "model": "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>        "max_tokens": 4096,&para;<br>        "messages": [{&para;<br>            "role": "user",&para;<br>            "content": "Write a file with a random number and save it to \"/tmp/number.txt\""&para;<br>        }],&para;<br>        "tools": [{&para;<br>            "type": "code_execution_20250825",&para;<br>            "name": "code_execution"&para;<br>        }]&para;<br>    }' &gt; response1.json&para;<br>&para;<br># Extract container ID from the response (using jq)&para;<br>CONTAINER_ID=$(jq -r '.container.id' response1.json)&para;<br>&para;<br># Second request: Reuse the container to read the file&para;<br>curl https://api.anthropic.com/v1/messages \&para;<br>    --header "x-api-key: $ANTHROPIC_API_KEY" \&para;<br>    --header "anthropic-version: 2023-06-01" \&para;<br>    --header "anthropic-beta: code-execution-2025-08-25" \&para;<br>    --header "content-type: application/json" \&para;<br>    --data '{&para;<br>        "container": "'$CONTAINER_ID'",&para;<br>        "model": "claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>        "max_tokens": 4096,&para;<br>        "messages": [{&para;<br>            "role": "user",&para;<br>            "content": "Read the number from \"/tmp/number.txt\" and calculate its square"&para;<br>        }],&para;<br>        "tools": [{&para;<br>            "type": "code_execution_20250825",&para;<br>            "name": "code_execution"&para;<br>        }]&para;<br>    }'&para;<br>```&para;<br>&lt;/CodeGroup&gt;&para;<br>&para;<br>## Streaming&para;<br>&para;<br>With streaming enabled, you'll receive code execution events as they occur:&para;<br>&para;<br>```javascript&para;<br>event: content_block_start&para;<br>data: {"type": "content_block_start", "index": 1, "content_block": {"type": "server_tool_use", "id": "srvtoolu_xyz789", "name": "code_execution"}}&para;<br>&para;<br>// Code execution streamed&para;<br>event: content_block_delta&para;<br>data: {"type": "content_block_delta", "index": 1, "delta": {"type": "input_json_delta", "partial_json": "{\"code\":\"import pandas as pd\\ndf = pd.read_csv('data.csv')\\nprint(df.head())\"}"}}&para;<br>&para;<br>// Pause while code executes&para;<br>&para;<br>// Execution results streamed&para;<br>event: content_block_start&para;<br>data: {"type": "content_block_start", "index": 2, "content_block": {"type": "code_execution_tool_result", "tool_use_id": "srvtoolu_xyz789", "content": {"stdout": "   A  B  C\n0  1  2  3\n1  4  5  6", "stderr": ""}}}&para;<br>```&para;<br>&para;<br>## Batch requests&para;<br>&para;<br>You can include the code execution tool in the [Messages Batches API](/docs/en/build-with-claude/batch-processing). Code execution tool calls through the Messages Batches API are priced the same as those in regular Messages API requests.&para;<br>&para;<br>## Usage and pricing&para;<br>&para;<br>Code execution tool usage is tracked separately from token usage. Execution time has a minimum of 5 minutes.&para;<br>If files are included in the request, execution time is billed even if the tool is not used due to files being preloaded onto the container.&para;<br>&para;<br>Each organization receives 1,550 free hours of usage with the code execution tool per month. Additional usage beyond the first 1,550 hours is billed at $0.05 per hour, per container.&para;<br>&para;<br>## Upgrade to latest tool version&para;<br>&para;<br>By upgrading to `code-execution-2025-08-25`, you get access to file manipulation and Bash capabilities, including code in multiple languages. There is no price difference.&para;<br>&para;<br>### What's changed&para;<br>&para;<br>| Component | Legacy | Current |&para;<br>|-----------|------------------|----------------------------|&para;<br>| Beta header | `code-execution-2025-05-22` | `code-execution-2025-08-25` |&para;<br>| Tool type | `code_execution_20250522` | `code_execution_20250825` |&para;<br>| Capabilities | Python only | Bash commands, file operations |&para;<br>| Response types | `code_execution_result` | `bash_code_execution_result`, `text_editor_code_execution_result` |&para;<br>&para;<br>### Backward compatibility&para;<br>&para;<br>- All existing Python code execution continues to work exactly as before&para;<br>- No changes required to existing Python-only workflows&para;<br>&para;<br>### Upgrade steps&para;<br>&para;<br>To upgrade, you need to make the following changes in your API requests:&para;<br>&para;<br>1. **Update the beta header**:&para;<br>   ```diff&para;<br>   - "anthropic-beta": "code-execution-2025-05-22"&para;<br>   + "anthropic-beta": "code-execution-2025-08-25"&para;<br>   ```&para;<br>&para;<br>2. **Update the tool type**:&para;<br>   ```diff&para;<br>   - "type": "code_execution_20250522"&para;<br>   + "type": "code_execution_20250825"&para;<br>   ```&para;<br>&para;<br>3. **Review response handling** (if parsing responses programmatically):&para;<br>   - The previous blocks for Python execution responses will no longer be sent&para;<br>   - Instead, new response types for Bash and file operations will be sent (see Response Format section)&para;<br>&para;<br>## Programmatic tool calling&para;<br>&para;<br>The code execution tool powers [programmatic tool calling](/docs/en/agents-and-tools/tool-use/programmatic-tool-calling), which allows Claude to write code that calls your custom tools programmatically within the execution container. This enables efficient multi-tool workflows, data filtering before reaching Claude's context, and complex conditional logic.&para;<br>&para;<br>&lt;CodeGroup&gt;&para;<br>```python Python&para;<br># Enable programmatic calling for your tools&para;<br>response = client.beta.messages.create(&para;<br>    model="claude-</span><del style="background:#ffe6e6;">sonnet</del><ins style="background:#e6ffe6;">opus</ins><span>-4-</span><del style="background:#ffe6e6;">5</del><ins style="background:#e6ffe6;">6</ins><span>",&para;<br>    betas=["advanced-tool-use-2025-11-20"],&para;<br>    max_tokens=4096,&para;<br>    messages=[{&para;<br>        "role": "user",&para;<br>        "content": "Get weather for 5 cities and find the warmest"&para;<br>    }],&para;<br>    tools=[&para;<br>        {&para;<br>            "type": "code_execution_20250825",&para;<br>            "name": "code_execution"&para;<br>        },&para;<br>        {&para;<br>            "name": "get_weather",&para;<br>            "description": "Get weather for a city",&para;<br>            "input_schema": {...},&para;<br>            "allowed_callers": ["code_execution_20250825"]  # Enable programmatic calling&para;<br>        }&para;<br>    ]&para;<br>)&para;<br>```&para;<br>&lt;/CodeGroup&gt;&para;<br>&para;<br>Learn more in the [Programmatic tool calling documentation](/docs/en/agents-and-tools/tool-use/programmatic-tool-calling).&para;<br>&para;<br>## Using code execution with Agent Skills&para;<br>&para;<br>The code execution tool enables Claude to use [Agent Skills](/docs/en/agents-and-tools/agent-skills/overview). Skills are modular capabilities consisting of instructions, scripts, and resources that extend Claude's functionality.&para;<br>&para;<br>Learn more in the [Agent Skills documentation](/docs/en/agents-and-tools/agent-skills/overview) and [Agent Skills API guide](/docs/en/build-with-claude/skills-guide).</span></div>
        </div>

        <h2 style="margin-top: 2rem; margin-bottom: 1rem;">Unified Diff</h2>
        <pre><code>--- a/agents-and-tools/tool-use/code-execution-tool.md
+++ b/agents-and-tools/tool-use/code-execution-tool.md
@@ -20,10 +20,11 @@
 
 | Model | Tool Version |
 |-------|--------------|
+| Claude Opus 4.6 (`claude-opus-4-6`) | `code_execution_20250825` |
+| Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`) | `code_execution_20250825` |
 | Claude Opus 4.5 (`claude-opus-4-5-20251101`) | `code_execution_20250825` |
 | Claude Opus 4.1 (`claude-opus-4-1-20250805`) | `code_execution_20250825` |
 | Claude Opus 4 (`claude-opus-4-20250514`) | `code_execution_20250825` |
-| Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`) | `code_execution_20250825` |
 | Claude Sonnet 4 (`claude-sonnet-4-20250514`) | `code_execution_20250825` |
 | Claude Sonnet 3.7 (`claude-3-7-sonnet-20250219`) ([deprecated](/docs/en/about-claude/model-deprecations)) | `code_execution_20250825` |
 | Claude Haiku 4.5 (`claude-haiku-4-5-20251001`) | `code_execution_20250825` |
@@ -49,7 +50,7 @@
     --header &#34;anthropic-beta: code-execution-2025-08-25&#34; \
     --header &#34;content-type: application/json&#34; \
     --data &#39;{
-        &#34;model&#34;: &#34;claude-sonnet-4-5&#34;,
+        &#34;model&#34;: &#34;claude-opus-4-6&#34;,
         &#34;max_tokens&#34;: 4096,
         &#34;messages&#34;: [
             {
@@ -70,7 +71,7 @@
 client = anthropic.Anthropic()
 
 response = client.beta.messages.create(
-    model=&#34;claude-sonnet-4-5&#34;,
+    model=&#34;claude-opus-4-6&#34;,
     betas=[&#34;code-execution-2025-08-25&#34;],
     max_tokens=4096,
     messages=[{
@@ -93,7 +94,7 @@
 
 async function main() {
   const response = await anthropic.beta.messages.create({
-    model: &#34;claude-sonnet-4-5&#34;,
+    model: &#34;claude-opus-4-6&#34;,
     betas: [&#34;code-execution-2025-08-25&#34;],
     max_tokens: 4096,
     messages: [
@@ -141,7 +142,7 @@
     --header &#34;anthropic-beta: code-execution-2025-08-25&#34; \
     --header &#34;content-type: application/json&#34; \
     --data &#39;{
-        &#34;model&#34;: &#34;claude-sonnet-4-5&#34;,
+        &#34;model&#34;: &#34;claude-opus-4-6&#34;,
         &#34;max_tokens&#34;: 4096,
         &#34;messages&#34;: [{
             &#34;role&#34;: &#34;user&#34;,
@@ -156,7 +157,7 @@
 
 ```python Python
 response = client.beta.messages.create(
-    model=&#34;claude-sonnet-4-5&#34;,
+    model=&#34;claude-opus-4-6&#34;,
     betas=[&#34;code-execution-2025-08-25&#34;],
     max_tokens=4096,
     messages=[{
@@ -172,7 +173,7 @@
 
 ```typescript TypeScript
 const response = await anthropic.beta.messages.create({
-  model: &#34;claude-sonnet-4-5&#34;,
+  model: &#34;claude-opus-4-6&#34;,
   betas: [&#34;code-execution-2025-08-25&#34;],
   max_tokens: 4096,
   messages: [{
@@ -199,7 +200,7 @@
     --header &#34;anthropic-beta: code-execution-2025-08-25&#34; \
     --header &#34;content-type: application/json&#34; \
     --data &#39;{
-        &#34;model&#34;: &#34;claude-sonnet-4-5&#34;,
+        &#34;model&#34;: &#34;claude-opus-4-6&#34;,
         &#34;max_tokens&#34;: 4096,
         &#34;messages&#34;: [{
             &#34;role&#34;: &#34;user&#34;,
@@ -214,7 +215,7 @@
 
 ```python Python
 response = client.beta.messages.create(
-    model=&#34;claude-sonnet-4-5&#34;,
+    model=&#34;claude-opus-4-6&#34;,
     betas=[&#34;code-execution-2025-08-25&#34;],
     max_tokens=4096,
     messages=[{
@@ -230,7 +231,7 @@
 
 ```typescript TypeScript
 const response = await anthropic.beta.messages.create({
-  model: &#34;claude-sonnet-4-5&#34;,
+  model: &#34;claude-opus-4-6&#34;,
   betas: [&#34;code-execution-2025-08-25&#34;],
   max_tokens: 4096,
   messages: [{
@@ -284,7 +285,7 @@
     --header &#34;anthropic-beta: code-execution-2025-08-25,files-api-2025-04-14&#34; \
     --header &#34;content-type: application/json&#34; \
     --data &#39;{
-        &#34;model&#34;: &#34;claude-sonnet-4-5&#34;,
+        &#34;model&#34;: &#34;claude-opus-4-6&#34;,
         &#34;max_tokens&#34;: 4096,
         &#34;messages&#34;: [{
             &#34;role&#34;: &#34;user&#34;,
@@ -312,7 +313,7 @@
 
 # Use the file_id with code execution
 response = client.beta.messages.create(
-    model=&#34;claude-sonnet-4-5&#34;,
+    model=&#34;claude-opus-4-6&#34;,
     betas=[&#34;code-execution-2025-08-25&#34;, &#34;files-api-2025-04-14&#34;],
     max_tokens=4096,
     messages=[{
@@ -343,7 +344,7 @@
 
   // Use the file_id with code execution
   const response = await anthropic.beta.messages.create({
-    model: &#34;claude-sonnet-4-5&#34;,
+    model: &#34;claude-opus-4-6&#34;,
     betas: [&#34;code-execution-2025-08-25&#34;, &#34;files-api-2025-04-14&#34;],
     max_tokens: 4096,
     messages: [{
@@ -379,7 +380,7 @@
 
 # Request code execution that creates files
 response = client.beta.messages.create(
-    model=&#34;claude-sonnet-4-5&#34;,
+    model=&#34;claude-opus-4-6&#34;,
     betas=[&#34;code-execution-2025-08-25&#34;, &#34;files-api-2025-04-14&#34;],
     max_tokens=4096,
     messages=[{
@@ -422,7 +423,7 @@
 async function main() {
   // Request code execution that creates files
   const response = await anthropic.beta.messages.create({
-    model: &#34;claude-sonnet-4-5&#34;,
+    model: &#34;claude-opus-4-6&#34;,
     betas: [&#34;code-execution-2025-08-25&#34;, &#34;files-api-2025-04-14&#34;],
     max_tokens: 4096,
     messages: [{
@@ -496,7 +497,7 @@
     --header &#34;anthropic-beta: code-execution-2025-08-25,files-api-2025-04-14&#34; \
     --header &#34;content-type: application/json&#34; \
     --data &#39;{
-        &#34;model&#34;: &#34;claude-sonnet-4-5&#34;,
+        &#34;model&#34;: &#34;claude-opus-4-6&#34;,
         &#34;max_tokens&#34;: 4096,
         &#34;messages&#34;: [{
             &#34;role&#34;: &#34;user&#34;,
@@ -526,7 +527,7 @@
 
 # Use it with code execution
 response = client.beta.messages.create(
-    model=&#34;claude-sonnet-4-5&#34;,
+    model=&#34;claude-opus-4-6&#34;,
     betas=[&#34;code-execution-2025-08-25&#34;, &#34;files-api-2025-04-14&#34;],
     max_tokens=4096,
     messages=[{
@@ -558,7 +559,7 @@
 
 // Use it with code execution
 const response = await anthropic.beta.messages.create({
-  model: &#34;claude-sonnet-4-5&#34;,
+  model: &#34;claude-opus-4-6&#34;,
   betas: [&#34;code-execution-2025-08-25&#34;, &#34;files-api-2025-04-14&#34;],
   max_tokens: 4096,
   messages: [{
@@ -796,7 +797,7 @@
 
 # First request: Create a file with a random number
 response1 = client.beta.messages.create(
-    model=&#34;claude-sonnet-4-5&#34;,
+    model=&#34;claude-opus-4-6&#34;,
     betas=[&#34;code-execution-2025-08-25&#34;],
     max_tokens=4096,
     messages=[{
@@ -815,7 +816,7 @@
 # Second request: Reuse the container to read the file
 response2 = client.beta.messages.create(
     container=container_id,  # Reuse the same container
-    model=&#34;claude-sonnet-4-5&#34;,
+    model=&#34;claude-opus-4-6&#34;,
     betas=[&#34;code-execution-2025-08-25&#34;],
     max_tokens=4096,
     messages=[{
@@ -837,7 +838,7 @@
 async function main() {
   // First request: Create a file with a random number
   const response1 = await anthropic.beta.messages.create({
-    model: &#34;claude-sonnet-4-5&#34;,
+    model: &#34;claude-opus-4-6&#34;,
     betas: [&#34;code-execution-2025-08-25&#34;],
     max_tokens: 4096,
     messages: [{
@@ -856,7 +857,7 @@
   // Second request: Reuse the container to read the file
   const response2 = await anthropic.beta.messages.create({
     container: containerId,  // Reuse the same container
-    model: &#34;claude-sonnet-4-5&#34;,
+    model: &#34;claude-opus-4-6&#34;,
     betas: [&#34;code-execution-2025-08-25&#34;],
     max_tokens: 4096,
     messages: [{
@@ -883,7 +884,7 @@
     --header &#34;anthropic-beta: code-execution-2025-08-25&#34; \
     --header &#34;content-type: application/json&#34; \
     --data &#39;{
-        &#34;model&#34;: &#34;claude-sonnet-4-5&#34;,
+        &#34;model&#34;: &#34;claude-opus-4-6&#34;,
         &#34;max_tokens&#34;: 4096,
         &#34;messages&#34;: [{
             &#34;role&#34;: &#34;user&#34;,
@@ -906,7 +907,7 @@
     --header &#34;content-type: application/json&#34; \
     --data &#39;{
         &#34;container&#34;: &#34;&#39;$CONTAINER_ID&#39;&#34;,
-        &#34;model&#34;: &#34;claude-sonnet-4-5&#34;,
+        &#34;model&#34;: &#34;claude-opus-4-6&#34;,
         &#34;max_tokens&#34;: 4096,
         &#34;messages&#34;: [{
             &#34;role&#34;: &#34;user&#34;,
@@ -996,7 +997,7 @@
 ```python Python
 # Enable programmatic calling for your tools
 response = client.beta.messages.create(
-    model=&#34;claude-sonnet-4-5&#34;,
+    model=&#34;claude-opus-4-6&#34;,
     betas=[&#34;advanced-tool-use-2025-11-20&#34;],
     max_tokens=4096,
     messages=[{
</code></pre>
    </div>
</body>
</html>